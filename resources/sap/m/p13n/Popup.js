/*!
 * OpenUI5
 * (c) Copyright 2026 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","sap/m/Button","sap/m/Bar","sap/m/Title","sap/m/MessageBox","sap/ui/Device","sap/m/Dialog","sap/m/ResponsivePopover","sap/m/p13n/Container","sap/m/p13n/AbstractContainerItem","sap/m/library","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/library","sap/ui/core/syncStyleClass","sap/ui/model/json/JSONModel","sap/ui/core/ShortcutHintsMixin"],(t,e,o,n,i,s,r,a,p,l,c,h,u,g,d,_,C)=>{"use strict";const{P13nPopupMode:f}=c;const{TitleLevel:P}=g;const y=t.extend("sap.m.p13n.Popup",{metadata:{library:"sap.m",properties:{title:{type:"string"},mode:{type:"sap.m.P13nPopupMode",defaultValue:f.Dialog},warningText:{type:"string"},reset:{type:"function"}},aggregations:{panels:{type:"sap.m.p13n.IContent",multiple:true},additionalButtons:{type:"sap.m.Button",multiple:true}},events:{open:{},close:{parameters:{reason:{type:"string"}}}}},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.style("height","100%");t.openEnd();t.renderControl(e.getAggregation("_content"));t.close("div")}}});y.prototype.LOCALIZATION_MODEL="$p13nPopupLocalization";y.prototype.init=function(){t.prototype.init.apply(this,arguments);this._aPanels=[];this._aCustomStyles=[];this.oResourceBundle=u.getResourceBundleFor("sap.m");const e=new _({confirmText:this.oResourceBundle.getText("p13n.POPUP_OK"),cancelText:this.oResourceBundle.getText("p13n.POPUP_CANCEL"),resetText:this.oResourceBundle.getText("p13n.POPUP_RESET")});this.setModel(e,this.LOCALIZATION_MODEL)};y.prototype.isOpen=function(){return!!this._bIsOpen};y.prototype.setMode=function(t){this.setProperty("mode",t);if(this._oPopup){this._oPopup.removeAllContent();this._oPopup.destroy();const t=this._createContainer();this.addDependent(t);this._oPopup=t}return this};y.prototype.setReset=function(t){if(this._oPopup){const t=this._oPopup.getCustomHeader();if(t){t.destroy()}this._oPopup.setCustomHeader(this._createTitle());this._oPopup.invalidate()}this.setProperty("reset",t);return this};y.prototype.open=function(t,e){if(!t&&this.getMode()==="Popover"){throw new Error("Please provide a source control!")}if(!this._oPopup){const t=this._createContainer(e);this.addDependent(t);this._oPopup=t;this._aCustomStyles.forEach(t=>{if(!this._oPopup.hasStyleClass(t)){this._oPopup.addStyleClass(t)}})}if(this.getMode()==="Dialog"){this._oPopup.open()}else{this._oPopup.openBy(t)}if(e?.activePanel){this._getContainer(true).switchView(e.activePanel)}const o=this.getParent();if(o&&o.hasStyleClass instanceof Function&&o.hasStyleClass("sapUiSizeCompact")&&!this._oPopup.hasStyleClass("sapUiSizeCompact")){this._oPopup.addStyleClass("sapUiSizeCompact")}const n=this.getResetButton();if(n){n.setEnabled(e?.enableReset)}this._bIsOpen=true;this.fireOpen()};y.prototype.addStyleClass=function(t){this._aCustomStyles.push(t);this._oPopup?.addStyleClass(t);return this};y.prototype.removeStyleClass=function(t){this._aCustomStyles.splice(this._aCustomStyles.indexOf(t),1);this._oPopup?.removeStyleClass(t)};y.prototype.insertAdditionalButton=function(t,e){this.insertAggregation("additionalButtons",t,e,true);this._oPopup.insertButton?.(t,e)};y.prototype.addPanel=function(t,e){const o=t.getBindingInfo("title");let n;if(o&&o.parts){n={parts:o.parts}}if(t.attachChange instanceof Function){t.attachChange(t=>{this.getResetButton()?.setEnabled(true)})}this._getContainer().addView(new l({key:e||t.getId(),text:n||(t.getTitle instanceof Function?t.getTitle():undefined),content:t}));this._aPanels.push(t);return this};y.prototype.removePanel=function(t){this._aPanels.splice(this._aPanels.indexOf(t),1);this._getContainer().removeView(this._getContainer().getView(t));return this};y.prototype.removeAllPanels=function(){this.getPanels().forEach(t=>{this.removePanel(t)})};y.prototype.getPanels=function(){return this._aPanels};y.prototype.getResetButton=function(){return h.getElementById(this.getId()+"-resetBtn")};y.prototype._createContainer=function(t){t=t?t:{};const e=this["_create"+this.getMode()].call(this,t);e.addStyleClass("sapMP13nPopup");e.isPopupAdaptationAllowed=()=>false;return e};y.prototype._createResponsivePopover=function(t){const e=this.getPanels();const o=e.length>1;const n=new a(this.getId()+"-responsivePopover",{title:this.getTitle(),horizontalScrolling:t.hasOwnProperty("horizontalScrolling")?t.horizontalScrolling:false,verticalScrolling:!o&&!(e[0]&&e[0].getVerticalScrolling instanceof Function&&e[0].getVerticalScrolling()),contentWidth:t.contentWidth?t.contentWidth:"30rem",resizable:t.hasOwnProperty("resizable")?t.resizable:true,contentHeight:t.contentHeight?t.contentHeight:"35rem",placement:t.placement?t.placement:"Bottom",content:o?this._getContainer():e[0],afterClose:()=>{this._onClose(n,"AutoClose")}});n.setCustomHeader(this._createTitle());return n};y.prototype._createDialog=function(t){const e=this.getPanels();const o=e.length>1;let n;if(e.length>0){const t=e[0];n=t.getInitialFocusedControl&&t.getInitialFocusedControl();if(!n&&o){n=this._getContainer()._getTabBar().getItems()[0]}}const i=new r(this.getId()+"-dialog",{initialFocus:n,title:this.getTitle(),horizontalScrolling:t.hasOwnProperty("horizontalScrolling")?t.horizontalScrolling:false,verticalScrolling:!o&&!(e[0]&&e[0].getVerticalScrolling instanceof Function&&e[0].getVerticalScrolling()),contentWidth:t.contentWidth?t.contentWidth:"40rem",contentHeight:t.contentHeight?t.contentHeight:"55rem",draggable:true,resizable:true,stretch:s.system.phone,content:o?this._getContainer():e[0],escapeHandler:()=>{this._onClose(i,"Escape")}});const a=this._createConfirmButton(i);const p=this._createCancelButton(i);i.addButton(a);i.addButton(p);i.setCustomHeader(this._createTitle());this.getAdditionalButtons().forEach(t=>{i.addButton(t)});return i};y.prototype._createConfirmButton=function(t){if(!this._oConfirmButton){this._oConfirmButton=new e(this.getId()+this._getIdPrefix()+"-confirmBtn",{text:`{${this.LOCALIZATION_MODEL}>/confirmText}`,type:"Emphasized",press:()=>{this._onClose(t,"Ok")}});const o=s.os.macintosh?this.oResourceBundle.getText("p13n.SHORTCUT_OK_MAC"):this.oResourceBundle.getText("p13n.SHORTCUT_OK");C.addConfig(this._oConfirmButton,{addAccessibilityLabel:true,message:o})}return this._oConfirmButton};y.prototype._createCancelButton=function(t){if(!this._oCancelButton){this._oCancelButton=new e(this.getId()+this._getIdPrefix()+"-cancelBtn",{text:`{${this.LOCALIZATION_MODEL}>/cancelText}`,press:()=>{this._onClose(t,"Cancel")}});C.addConfig(this._oCancelButton,{addAccessibilityLabel:true,message:this.oResourceBundle.getText("p13n.SHORTCUT_CANCEL")})}return this._oCancelButton};y.prototype._getIdPrefix=()=>"";y.prototype._createTitle=function(){const t=this.getReset();const s=this.getTitle();const r=this.getWarningText();const a=this;let p;if(t instanceof Function){p=new o({contentLeft:[new n({text:s,level:P.H1})]});p.addContentRight(new e(this.getId()+"-resetBtn",{text:`{${this.LOCALIZATION_MODEL}>/resetText}`,press:function(e){const o=e.getSource().getParent().getParent();const n=o.getParent();const s=r;i.warning(s,{actions:[i.Action.OK,i.Action.CANCEL],emphasizedAction:i.Action.OK,closeOnNavigation:true,dependentOn:this,onClose:s=>{if(s===i.Action.OK){o.getButtons()[0].focus();e.getSource().setEnabled(false);a._resetPanels();t(n)}}})}}))}return p};y.prototype._resetPanels=function(){this.getPanels().forEach(t=>{if(t.onReset instanceof Function){t.onReset()}})};y.prototype._getContainer=function(t){if(!this._oContainer){this._oContainer=new p}if(this._oContainer.getViews().length>1&&!t){this._oContainer.switchView(this._oContainer.getViews()[1].getKey())}return this._oContainer};y.prototype._onClose=function(t,e){if(!t&&!this._oPopup){return}(t||this._oPopup).close();this._bIsOpen=false;this.fireClose({reason:e})};y.prototype.onlocalizationChanged=function(){this._onLocalizationChanged()};y.prototype.onLocalizationChanged=function(){this._onLocalizationChanged()};y.prototype._onLocalizationChanged=function(){this.oResourceBundle=u.getResourceBundleFor("sap.m");this.getModel(this.LOCALIZATION_MODEL).setProperty("/confirmText",this.oResourceBundle.getText("p13n.POPUP_OK"));this.getModel(this.LOCALIZATION_MODEL).setProperty("/cancelText",this.oResourceBundle.getText("p13n.POPUP_CANCEL"));this.getModel(this.LOCALIZATION_MODEL).setProperty("/resetText",this.oResourceBundle.getText("p13n.POPUP_RESET"))};y.prototype.exit=function(){t.prototype.exit.apply(this,arguments);if(this._oPopup){this._oPopup.destroy()}this._aPanels=null;this._aCustomStyles=null};return y});
//# sourceMappingURL=Popup.js.map