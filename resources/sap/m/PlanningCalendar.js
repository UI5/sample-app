/*!
 * OpenUI5
 * (c) Copyright 2026 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/i18n/Formatting","sap/base/i18n/Localization","sap/m/delegate/DateNavigation","sap/ui/core/Control","sap/ui/base/ManagedObjectObserver","sap/ui/core/Lib","sap/ui/unified/library","sap/ui/unified/calendar/CalendarUtils","sap/ui/unified/calendar/CalendarDate","sap/ui/unified/calendar/DatesRow","sap/ui/unified/calendar/OneMonthDatesRow","sap/ui/unified/calendar/MonthsRow","sap/ui/unified/calendar/TimesRow","sap/ui/unified/calendar/WeeksRow","sap/ui/unified/DateRange","sap/ui/unified/DateTypeRange","sap/ui/unified/CalendarAppointment","sap/ui/unified/CalendarRow","sap/ui/unified/CalendarRowRenderer","sap/ui/Device","sap/ui/core/Element","sap/ui/core/Renderer","sap/ui/core/ResizeHandler","sap/ui/core/InvisibleText","sap/ui/core/dnd/DragInfo","sap/ui/core/dnd/DropInfo","sap/ui/core/dnd/DragDropInfo","sap/ui/core/format/DateFormat","sap/base/i18n/date/CalendarType","sap/base/i18n/date/CalendarWeekNumbering","sap/ui/core/date/CalendarUtils","sap/ui/core/Locale","sap/ui/core/date/UI5Date","sap/ui/events/KeyCodes","sap/m/Avatar","sap/m/Toolbar","sap/m/Table","sap/m/Column","sap/m/ColumnListItem","sap/m/ColumnListItemRenderer","sap/m/SegmentedButtonItem","sap/m/StandardListItem","sap/m/PlanningCalendarHeader","sap/m/PlanningCalendarRenderer","sap/m/PlanningCalendarView","sap/m/CheckBox","sap/m/library","sap/base/util/deepEqual","sap/base/Log","sap/m/List","sap/ui/thirdparty/jquery","sap/ui/dom/jquery/control"],function(e,t,a,i,n,s,r,o,l,h,g,d,p,c,u,f,_,y,m,D,v,w,C,S,T,R,A,I,M,k,b,P,V,H,O,N,W,E,L,U,B,x,z,K,F,J,j,Y,$,G,jQuery){"use strict";var q=j.Sticky;var X=r.CalendarDayType;var Q=j.ListMode;var Z=j.ToolbarDesign;var ee=j.PlanningCalendarBuiltInView;var te=j.ScreenSize;var ae=r.CalendarAppointmentVisualization;var ie=r.GroupAppointmentsMode;var ne=r.CalendarIntervalType;var se=r.CalendarAppointmentHeight;var re=r.CalendarAppointmentRoundWidth;var oe=j.AvatarShape;var le="DragDropConfig";var he="ResizeConfig";var ge="CreateConfig";var de="-CLI";var pe=i.extend("sap.m.PlanningCalendar",{metadata:{library:"sap.m",properties:{startDate:{type:"object",group:"Data"},viewKey:{type:"string",group:"Appearance",defaultValue:ne.Hour},singleSelection:{type:"boolean",group:"Misc",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},showIntervalHeaders:{type:"boolean",group:"Appearance",defaultValue:true},showEmptyIntervalHeaders:{type:"boolean",group:"Appearance",defaultValue:true},showRowHeaders:{type:"boolean",group:"Appearance",defaultValue:true},noDataText:{type:"string",group:"Misc",defaultValue:null},groupAppointmentsMode:{type:"sap.ui.unified.GroupAppointmentsMode",group:"Appearance",defaultValue:ie.Collapsed},appointmentsReducedHeight:{type:"boolean",group:"Appearance",defaultValue:false,deprecated:true},appointmentHeight:{type:"sap.ui.unified.CalendarAppointmentHeight",group:"Appearance",defaultValue:se.Regular},appointmentRoundWidth:{type:"sap.ui.unified.CalendarAppointmentRoundWidth",group:"Appearance",defaultValue:re.None},appointmentsVisualization:{type:"sap.ui.unified.CalendarAppointmentVisualization",group:"Appearance",defaultValue:ae.Standard},minDate:{type:"object",group:"Misc",defaultValue:null},maxDate:{type:"object",group:"Misc",defaultValue:null},showDayNamesLine:{type:"boolean",group:"Appearance",defaultValue:false},showWeekNumbers:{type:"boolean",group:"Appearance",defaultValue:false},builtInViews:{type:"string[]",group:"Appearance",defaultValue:[]},stickyHeader:{type:"boolean",group:"Appearance",defaultValue:false},firstDayOfWeek:{type:"int",group:"Appearance",defaultValue:-1},calendarWeekNumbering:{type:"sap.base.i18n.date.CalendarWeekNumbering",group:"Appearance",defaultValue:null},primaryCalendarType:{type:"sap.base.i18n.date.CalendarType",group:"Appearance"},secondaryCalendarType:{type:"sap.base.i18n.date.CalendarType",group:"Appearance"},multipleAppointmentsSelection:{type:"boolean",group:"Data",defaultValue:false},iconShape:{type:"sap.m.AvatarShape",group:"Appearance",defaultValue:oe.Circle}},aggregations:{rows:{type:"sap.m.PlanningCalendarRow",multiple:true,singularName:"row"},views:{type:"sap.m.PlanningCalendarView",multiple:true,singularName:"view"},specialDates:{type:"sap.ui.unified.DateTypeRange",multiple:true,singularName:"specialDate"},toolbarContent:{type:"sap.ui.core.Control",multiple:true,singularName:"toolbarContent",forwarding:{getter:"_getHeader",aggregation:"actions"}},table:{type:"sap.m.Table",multiple:false,visibility:"hidden"},header:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},noData:{type:"sap.ui.core.Control",multiple:false,altTypes:["string"],forwarding:{idSuffix:"-Table",aggregation:"noData"}}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"},legend:{type:"sap.ui.unified.CalendarLegend",multiple:false}},events:{appointmentSelect:{parameters:{appointment:{type:"sap.ui.unified.CalendarAppointment"},appointments:{type:"sap.ui.unified.CalendarAppointment[]"},multiSelect:{type:"boolean"},domRefId:{type:"string"}}},intervalSelect:{parameters:{startDate:{type:"object"},endDate:{type:"object"},subInterval:{type:"boolean"},row:{type:"sap.m.PlanningCalendarRow"}}},rowSelectionChange:{parameters:{rows:{type:"sap.m.PlanningCalendarRow[]"}}},startDateChange:{},viewChange:{},rowHeaderClick:{parameters:{headerId:{type:"string"},row:{type:"sap.m.PlanningCalendarRow"}}},rowHeaderPress:{parameters:{headerId:{type:"string"},row:{type:"sap.m.PlanningCalendarRow"}}}},designtime:"sap/m/designtime/PlanningCalendar.designtime"},constructor:function(e,t){i.prototype.constructor.apply(this,arguments);if(typeof e!=="string"){t=e}if(t&&typeof t.customAppointmentsSorterCallback==="function"){this._fnCustomSortedAppointments=t.customAppointmentsSorterCallback}},renderer:K});var ce=["_oTimesRow","_oDatesRow","_oMonthsRow","_oWeeksRow","_oOneMonthsRow"],ue={};ue[ne.Day]={sInstanceName:"_oDatesRow",sIdSuffix:"-DatesRow",oClass:h};ue[ne.Week]={sInstanceName:"_oWeeksRow",sIdSuffix:"-WeeksRow",oClass:h};ue[ne.OneMonth]={sInstanceName:"_oOneMonthsRow",sIdSuffix:"-OneMonthsRow",oClass:g};var fe=te.Desktop;var _e=[ee.Hour,ee.Day,ee.Month,ee.Week,ee.OneMonth];var ye={PHONE:"600",TABLET:"1024"};var me={MONTH:"month",MONTH_PICKER:"monthPicker",YEAR_PICKER:"yearPicker",YEAR_RANGE_PICKER:"yearRangePicker"};var De={onAfterRendering:function(){this.setProperty("_currentPicker",me.MONTH);this.removeDelegate(De)}};var ve={onAfterRendering:function(){this.setProperty("_currentPicker",me.MONTH_PICKER);this.removeDelegate(ve)}};var we={onAfterRendering:function(){this.setProperty("_currentPicker",me.YEAR_PICKER);this.removeDelegate(we)}};var Ce=["sap.ui.unified.calendar.TimesRow","sap.ui.unified.calendar.DatesRow","sap.ui.unified.calendar.MonthsRow","sap.ui.unified.calendar.OneMonthDatesRow","sap.ui.unified.calendar.WeeksRow"];var Se=i.extend("sap.m._PlanningCalendarInternalHeader",{metadata:{properties:{showWeekNumbers:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{toolbar:{type:"sap.m.Toolbar",multiple:false},allCheckBox:{type:"sap.m.CheckBox",multiple:false}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t);e.class("sapMPlanCalHead");e.openEnd();var a=t.getToolbar();if(a){e.renderControl(a)}var i=t.getAllCheckBox();if(i){e.renderControl(i)}e.close("div")}}});pe.prototype.init=function(){this._dateNav=new a;this._iBreakPointTablet=D.media._predefinedRangeSets[D.media.RANGESETS.SAP_STANDARD_EXTENDED].points[0];this._iBreakPointDesktop=D.media._predefinedRangeSets[D.media.RANGESETS.SAP_STANDARD_EXTENDED].points[1];this._iBreakPointLargeDesktop=D.media._predefinedRangeSets[D.media.RANGESETS.SAP_STANDARD_EXTENDED].points[2];if(D.system.phone||jQuery("html").hasClass("sapUiMedia-Std-Phone")){this._iSize=0;this._iSizeScreen=0}else if((D.system.tablet||jQuery("html").hasClass("sapUiMedia-Std-Tablet"))&&!(D.system.desktop||jQuery("html").hasClass("sapUiMedia-Std-Desktop"))){this._iSize=1;this._iSizeScreen=1}else{this._iSize=2;this._iSizeScreen=2}this.addStyleClass("sapMSize"+this._iSize);this.setAggregation("header",this._createHeader());this._attachHeaderEvents();this._oRB=s.getResourceBundleFor("sap.m");var e=this.getId();this._oIntervalTypeSelect=this._getHeader()._getOrCreateViewSwitch();this._oIntervalTypeSelect.attachEvent("selectionChange",Te,this);this._oTodayButton=this._getHeader()._getTodayButton();this._oCalendarHeader=new Se(e+"-CalHead",{});this._oCalendarHeader.isRelative=this.isRelative.bind(this);this._oCalendarHeader._getRelativeInfo=this._getRelativeInfo.bind(this);this._oInfoToolbar=new N(e+"-InfoToolbar",{height:"auto",design:Z.Transparent,content:[this._oCalendarHeader,this._oTimesRow],ariaLabelledBy:S.getStaticId("sap.m","PC_INTERVAL_TOOLBAR")});this._oInfoToolbar.addStyleClass("sapMPlanCalInfoToolbar");var t=new W(e+"-Table",{sticky:[],infoToolbar:this._oInfoToolbar,mode:Q.SingleSelectMaster,columns:[new E({styleClass:"sapMPlanCalRowHead"}),new E({width:"80%",styleClass:"sapMPlanCalAppRow",minScreenWidth:fe,demandPopin:true})],ariaLabelledBy:`${this.getId()}-Descr`});t.attachEvent("selectionChange",xe,this);t.addDelegate({onBeforeRendering:function(){if(this._rowHeaderPressEventMouse){this._rowHeaderPressEventMouse.off()}if(this._rowHeaderPressEventKeyboard){this._rowHeaderPressEventKeyboard.off()}},onAfterRendering:function(){if(this.hasListeners("rowHeaderPress")){this._addRowHeaderDescription()}const e=t.$().find(".sapMPlanCalRowHead");this._rowHeaderPressEventMouse=e.on("click",function(e){const t=v.closestTo(e.currentTarget),a=We(t),i=t.getAggregation("cells")[0].getId();this.fireRowHeaderClick({headerId:i,row:a});this.fireRowHeaderPress({headerId:i,row:a})}.bind(this));this._rowHeaderPressEventKeyboard=e.on("keydown",function(e){if(e.which===H.SPACE||e.which===H.ENTER){e.preventDefault();var t=v.closestTo(e.currentTarget),a=We(t),i=t.getAggregation("cells")[0].getId();this.fireRowHeaderPress({headerId:i,row:a})}}.bind(this));this._adjustColumnHeadersTopOffset()}},false,this);t.getStickyFocusOffset=qe.bind(this);this.setAggregation("table",t,true);this.setStartDate(V.getInstance());this._resizeProxy=Me.bind(this);this._fnCustomSortedAppointments=undefined;this.iWidth=0};pe.prototype.exit=function(){if(this._sResizeListener){C.deregister(this._sResizeListener);this._sResizeListener=undefined}D.orientation.detachHandler(this._updateStickyHeader,this);if(this._sUpdateCurrentTime){clearTimeout(this._sUpdateCurrentTime);this._sUpdateCurrentTime=undefined}var e=this.getAggregation("table");e.removeAllItems();ce.forEach(function(e){if(this[e]){this[e]._oPlanningCalendar=undefined;this[e].destroy();this[e]=undefined}},this);if(this._oViews){for(var t in this._oViews){this._oViews[t].destroy()}}if(this._oSelectAllCheckBox){this._oSelectAllCheckBox.destroy()}if(this._rowHeaderPressEventMouse){this._rowHeaderPressEventMouse.off();this._rowHeaderPressEventMouse=null}if(this._rowHeaderPressEventKeyboard){this._rowHeaderPressEventKeyboard.off();this._rowHeaderPressEventKeyboard=null}if(this._oCalendarWeeks){this._oCalendarWeeks.destroy();this._oCalendarWeeks=null}};pe.prototype.onBeforeRendering=function(){this._bBeforeRendering=true;this._updateHeader();this._adjustViewKey();Fe.call(this);if(this._sUpdateCurrentTime){clearTimeout(this._sUpdateCurrentTime);this._sUpdateCurrentTime=undefined}this._updatePickerSelection();this._updateHeaderButtons();D.orientation.detachHandler(this._updateStickyHeader,this);this._bBeforeRendering=undefined;this._toggleStickyClasses();Be.call(this);this._setProperties()};pe.prototype._setProperties=function(){const e=this.getMultipleAppointmentsSelection(),t=this.getIconShape(),a=this.getStartDate(),i=this.getAppointmentHeight(),n=this.getAppointmentRoundWidth(),s=this.getShowIntervalHeaders(),r=this.getShowEmptyIntervalHeaders(),o=this.getAppointmentsVisualization(),l=this.getGroupAppointmentsMode(),h=this.getAppointmentsReducedHeight(),g=this.getLegend();this.getRows().forEach(function(d){const p=Le(d),c=Ue(d);if(p.getAvatar){p.getAvatar().setDisplayShape(t)}c.setMultipleAppointmentsSelection(e);c.setStartDate(a);c.setAppointmentHeight(i);c.setAppointmentRoundWidth(n);c.setShowIntervalHeaders(s);c.setShowEmptyIntervalHeaders(r);c.setAppointmentsVisualization(o);c.setGroupAppointmentsMode(l);c.setAppointmentsReducedHeight(h);c.setLegend(g)});this._setPrimaryCalendarType();this._setSecondaryCalendarType();this._setFirstDayOfWeek();this._setCalendarWeekNumbering();this._setShowWeekNumbers();this._setShowRowHeaders();this._setShowDayNamesLine();this._setStickyHeader();this._setNoDataText();this._setLegend(g)};pe.prototype._bindAggregation=function(e,t){if(e==="rows"){Xe(t,"dataRequested",this._onBindingDataRequestedListener.bind(this));Xe(t,"dataReceived",this._onBindingDataReceivedListener.bind(this))}i.prototype._bindAggregation.call(this,e,t)};pe.prototype._onBindingDataRequestedListener=function(e){this.getAggregation("table").setBusy(true,"listUl")};pe.prototype._onBindingDataReceivedListener=function(e){this.getAggregation("table").setBusy(false,"listUl")};pe.prototype._updateHeader=function(){this._getHeader().setProperty("_primaryCalendarType",this._getPrimaryCalendarType());if(this._getSecondaryCalendarType()){this.setShowDayNamesLine(true);this._getHeader().setProperty("_secondaryCalendarType",this.getSecondaryCalendarType())}return this};pe.prototype.attachEvent=function(e,t,a,n){i.prototype.attachEvent.call(this,e,t,a,n);if(this.hasListeners("intervalSelect")){ce.forEach(function(e){if(this[e]){this[e]._setAriaRole("columnheader")}},this)}else if(this.hasListeners("rowHeaderPress")&&this.getDomRef()){this._addRowHeaderDescription()}return this};pe.prototype.detachEvent=function(e,t,a){i.prototype.detachEvent.call(this,e,t,a);if(!this.hasListeners("intervalSelect")){ce.forEach(function(e){if(this[e]){this[e]._setAriaRole("gridcell")}},this)}return this};pe.prototype._createHeader=function(){var e=new z(this.getId()+"-Header",{calendarWeekNumbering:this.getCalendarWeekNumbering()});e._getRelativeInfo=this._getRelativeInfo.bind(this);e.getAggregation("_actionsToolbar").addAriaLabelledBy(S.getStaticId("sap.m","PC_FUNCTIONS_TOOLBAR"));e.getAggregation("_navigationToolbar").addAriaLabelledBy(S.getStaticId("sap.m","PC_INTERVAL_SELECTION_TOOLBAR"));return e};pe.prototype._attachHeaderEvents=function(){var e=this._getHeader();e.attachEvent("pressPrevious",this._handlePressArrow,this);e.attachEvent("pressToday",this._handleTodayPress,this);e.attachEvent("pressNext",this._handlePressArrow,this);e.attachEvent("dateSelect",this._handleDateSelect,this);e.attachEvent("_titleChange",this._handleTitleChange,this);return this};pe.prototype._handleTitleChange=function(e){const t=e.getParameter("title");const a=t?.getId()||"";this.getDomRef()?.setAttribute("aria-labelledby",a);this._resetTableLabelledBy(t)};pe.prototype._handlePressArrow=function(e){this._applyArrowsLogic(e.getId()==="pressPrevious")};pe.prototype._applyArrowsLogic=function(e){if(e){this._dateNav.previous(this._getPrimaryCalendarType())}else{this._dateNav.next(this._getPrimaryCalendarType())}var t=this._getRowInstanceByViewKey(this.getViewKey());this.setStartDate(this._dateNav.getStart());t.displayDate(this._dateNav.getCurrent());this._updatePickerSelection();this.fireStartDateChange()};pe.prototype._addRowHeaderDescription=function(){const e=this.getAggregation("table").getItems();e.forEach(function(e){const t=e.getTimeline().getAssociation("row"),a=v.getElementById(t),i=a.getRowHeaderDescription()||this._oRB.getText("PLANNING_CALENDAR_ROW_HEADER_DESCRIPTION");e.getDomRef().querySelector(".sapMPlanCalRowHead").setAttribute("aria-description",i)},this)};pe.prototype._formatPickerText=function(){var e=this._getFirstAndLastRangeDate(),a=o._createLocalDate(e.oStartDate,true),i=o._createLocalDate(e.oEndDate,true),n=this.getViewKey(),s=ne[n]?ne[n]:this._getView(n).getIntervalType(),r=t.getRTL(),l,h,g,d,p,c,u,f;if(this._getSecondaryCalendarType()){p=I.getDateInstance({format:"yMMMMd",calendarType:this.getSecondaryCalendarType()})}switch(s){case ne.Hour:l=I.getDateInstance({format:"yMMMMd",calendarType:this._getPrimaryCalendarType()});g=l.format(a);if(a.getDate()!==i.getDate()){d=l.format(i)}if(this._getSecondaryCalendarType()){c=p.format(a);if(a.getDate()!==i.getDate()){u=p.format(i)}}break;case ne.Day:case ne.Week:var _=this._getRelativeInfo().intervalLabelFormatter;if(this.isRelative()){var y=this.calcIntervalOffset(this.getStartDate());var m=this.calcIntervalOffset(this.getEndDate())-this.calcIntervalOffset(this.getStartDate());g=_?_(y):y;var D=this._getRelativeInfo().iIntervalSize===1?y+m:y+m-1;d=_?_(D):y+m}else{l=I.getDateInstance({format:"yMMMMd",calendarType:this._getPrimaryCalendarType()});g=l.format(a);d=l.format(i);if(this._getSecondaryCalendarType()){c=p.format(a);u=p.format(i)}}break;case ne.OneMonth:case"OneMonth":l=I.getDateInstance({format:"yMMMM",calendarType:this._getPrimaryCalendarType()});g=l.format(a);if(this._getSecondaryCalendarType()){p=I.getDateInstance({format:"yMMMM",calendarType:this.getSecondaryCalendarType()});c=p.format(a)}break;case ne.Month:l=I.getDateInstance({format:"y",calendarType:this._getPrimaryCalendarType()});g=l.format(a);if(this._getSecondaryCalendarType()){p=I.getDateInstance({format:"y",calendarType:this.getSecondaryCalendarType()});c=p.format(a)}if(a.getFullYear()!==i.getFullYear()){d=l.format(i);if(this._getSecondaryCalendarType()){u=p.format(i)}}if(g===d){d=undefined}break;default:throw new Error("Unknown IntervalType: "+n+"; "+this)}if(!r){h=g;f=c;if(d){h+=" - "+d}if(this._getSecondaryCalendarType()&&u){f+=" - "+u}}else{if(d){h=d+" - "+g}else{h=g}if(this._getSecondaryCalendarType()&&u){f=c+" - "+u}else if(this._getSecondaryCalendarType()){f=c}}return{primaryType:h,secondaryType:f}};pe.prototype._getPrimaryCalendarType=function(){return this.getProperty("primaryCalendarType")||e.getCalendarType()};pe.prototype._getFirstAndLastRangeDate=function(){var e=this.getStartDate(),t=this.getMinDate(),a=e,i,n;if(t&&t.getTime()>e.getTime()&&this._isWeekOrOneMonthView(this.getViewKey())){a=t}i=o._createUniversalUTCDate(a,this._getPrimaryCalendarType(),true);n=o._createUniversalUTCDate(this._dateNav.getEnd(),this._getPrimaryCalendarType(),true);return{oStartDate:i,oEndDate:n}};pe.prototype._getHeader=function(){return this.getAggregation("header")};pe.prototype._toggleStickyClasses=function(){this.toggleStyleClass("sapMPCSticky",this.getStickyHeader());return this};pe.prototype._adjustColumnHeadersTopOffset=function(){var e=this.getStickyHeader(),t=this.getDomRef().querySelector(".sapMListInfoTBarContainer"),a;switch(e){case true:a=this._getHeader().$().outerHeight()+"px";break;default:a="auto";break}t.style.top=a;return this};pe.prototype.getEndDate=function(){return this._dateNav.getEnd(this._getPrimaryCalendarType())};pe.prototype.getVisibleIntervalsCount=function(){if(this._isOneMonthView(this.getViewKey())&&this._iSize<2){const e=this._oOneMonthsRow._getVisibleDays();return e.length}else{return this._getIntervals(this._getView(this.getViewKey()))}};pe.prototype._setAriaRole=function(e){if(this.hasListeners("intervalSelect")){e._setAriaRole("columnheader")}else{e.setProperty("selectableAccessibilitySemantics",false);e._setAriaRole("gridcell")}};pe.prototype._updateTodayButtonState=function(){if(!this._oTodayButton){return}if(this.isRelative()){this._oTodayButton.setEnabled(false);return}this._oTodayButton.setEnabled(!this._dateMatchesVisibleRange(V.getInstance(),this.getViewKey()))};pe.prototype._dateMatchesVisibleRange=function(e,t){var a=this._getView(t,!this._bBeforeRendering);if(!a){return false}var i=a.getIntervalType(),n=ue[i],s=n?this[n.sInstanceName]:null,r=false;if(s&&t==="One Month"){return o._isSameMonthAndYear(l.fromLocalJSDate(this.getStartDate()),l.fromLocalJSDate(e))}else if(s&&t==="Week"){var h=s.getDays(),g=l.fromLocalJSDate(e),d=l.fromLocalJSDate(this.getStartDate()),p=l.fromLocalJSDate(this.getStartDate());p.setDate(p.getDate()+h);return g.isSameOrAfter(d)&&g.isBefore(p)}return r};pe.prototype.onAfterRendering=function(e){e.size={width:this.getDomRef().offsetWidth};Me.call(this,e,true);if(!this._sResizeListener){this._sResizeListener=C.register(this,this._resizeProxy)}if(D.system.phone&&this.getStickyHeader()){D.orientation.attachHandler(this._updateStickyHeader,this)}this._updateCurrentTimeVisualization(false);if(this.getHeight()){var t=this.getDomRef().querySelector("table");if(this.getHeight().indexOf("%")>-1){t.style.height=this.getHeight();return}var a=this.$().height()-this._oInfoToolbar.$().height()+"px";t.style.height=a}this._adjustColumnHeadersTopOffset();this._updateHeaderButtons()};pe.prototype.onThemeChanged=function(){if(this.getDomRef()){this._adjustColumnHeadersTopOffset()}};pe.prototype.setStartDate=function(e){var t,a=this.getMinDate(),i=this.getViewKey();if(!e){t=V.getInstance()}else{o._checkJSDateObject(e);t=V.getInstance(e.getTime())}t=this._shiftStartDate(t);if(Y(t,this.getStartDate())){this._updateTodayButtonState();return this}var n=t.getFullYear();o._checkYearInValidRange(n);if(a&&a.getTime()>t.getTime()){if(!this._isWeekOrOneMonthView(i)){$.warning("StartDate < minDate -> StartDate set to minDate",this);t=V.getInstance(a.getTime())}}else{var s=this.getMaxDate();if(s&&s.getTime()<t.getTime()){$.warning("StartDate > maxDate -> StartDate set to minDate",this);if(a){t=V.getInstance(a.getTime())}else{t=V.getInstance(1,0,1);t.setFullYear(1)}}}this.setProperty("startDate",t,true);this._dateNav.setStart(t);this._dateNav.setCurrent(t);this._getHeader().setStartDate(t);this._oCalendarWeeks?.setStartDate(t);ce.forEach(function(e){if(this[e]){this[e].setStartDate(V.getInstance(t.getTime()))}},this);if(this._isOneMonthView(i)&&this._oOneMonthsRow&&this._oOneMonthsRow.getMode()<2&&this._oOneMonthsRow.getSelectedDates().length){this._setRowsStartDate(this._oOneMonthsRow.getSelectedDates()[0].getStartDate())}else{this._setRowsStartDate(V.getInstance(t.getTime()))}if(this._isWeekOrOneMonthView(i)){this._updateTodayButtonState()}if(this.getDomRef()){this._updateCurrentTimeVisualization(false);this._updatePickerSelection()}this._updateHeaderButtons();return this};pe.prototype._setPrimaryCalendarType=function(){var e=this._getPrimaryCalendarType();if(this._getHeader()){this._getHeader().setProperty("_primaryCalendarType",e)}if(this._oTimesRow){this._oTimesRow.setProperty("primaryCalendarType",e)}if(this._oDatesRow){this._oDatesRow.setPrimaryCalendarType(e)}if(this._oMonthsRow){this._oMonthsRow.setProperty("primaryCalendarType",e)}if(this._oWeeksRow){this._oWeeksRow.setPrimaryCalendarType(e)}if(this._oOneMonthsRow){this._oOneMonthsRow.setPrimaryCalendarType(e)}if(this._oCalendarWeeks){this._oCalendarWeeks.setPrimaryCalendarType(e)}};pe.prototype._getSecondaryCalendarType=function(){var e=this.getSecondaryCalendarType();if(e===this._getPrimaryCalendarType()){return undefined}return e};pe.prototype._setSecondaryCalendarType=function(){var e=this._getSecondaryCalendarType();if(this._getHeader()){this._getHeader().setProperty("_secondaryCalendarType",e)}if(this._oTimesRow){this._oTimesRow.setProperty("secondaryCalendarType",e)}if(this._oDatesRow){this._oDatesRow.setSecondaryCalendarType(e)}if(this._oMonthsRow){this._oMonthsRow.setSecondaryCalendarType(e)}if(this._oWeeksRow){this._oWeeksRow.setSecondaryCalendarType(e)}if(this._oOneMonthsRow){this._oOneMonthsRow.setSecondaryCalendarType(e)}};pe.prototype.setMinDate=function(e){if(Y(e,this.getMinDate())){return this}var t=this.getMaxDate(),a=this._getHeader(),i;if(e){o._checkJSDateObject(e);var n=e.getFullYear();o._checkYearInValidRange(n);i=V.getInstance(e.getTime());this.setProperty("minDate",i,true);this._bNoStartDateChange=true;a.getAggregation("_calendarPicker").setMinDate(i);a.getAggregation("_monthPicker").setMinDate(i);a.getAggregation("_yearPicker").setMinDate(i);if(this._oDatesRow){this._oDatesRow._oMinDate=i;this._oDatesRow.invalidate()}if(this._oWeeksRow){this._oWeeksRow._oMinDate=i;this._oWeeksRow.invalidate()}if(this._oOneMonthsRow){this._oOneMonthsRow._oMinDate=i;this._oOneMonthsRow.invalidate()}if(t&&t.getTime()<e.getTime()){$.warning("minDate > maxDate -> maxDate set to end of the month",this);t=i;t.setMonth(t.getMonth()+1,0);t.setHours(23);t.setMinutes(59);t.setSeconds(59);t.setMilliseconds(0);this.setMaxDate(t)}this._bNoStartDateChange=undefined;var s=this.getStartDate();if(s&&s.getTime()<i.getTime()){$.warning("StartDate < minDate -> StartDate set to minDate",this);s=i;this.setStartDate(s);a.updatePickerText(this._formatPickerText())}}else{this.setProperty("minDate",undefined,true);a.getAggregation("_calendarPicker").setMinDate();a.getAggregation("_monthPicker").setMinDate();a.getAggregation("_yearPicker").setMinDate()}var r=V.getInstance();if(e&&r.getTime()<i.getTime()){this._oTodayButton.setVisible(false)}else if(!t||r.getTime()<t.getTime()){this._oTodayButton.setVisible(true)}if(this.getDomRef()){this._updatePickerSelection();this._updateHeaderButtons()}return this};pe.prototype.setMaxDate=function(e){if(Y(e,this.getMaxDate())){return this}var t=this.getMinDate(),a=this._getHeader(),i;if(e){o._checkJSDateObject(e);var n=e.getFullYear();o._checkYearInValidRange(n);i=V.getInstance(e.getTime());this.setProperty("maxDate",i,true);this._bNoStartDateChange=true;a.getAggregation("_calendarPicker").setMaxDate(i);a.getAggregation("_monthPicker").setMaxDate(i);a.getAggregation("_yearPicker").setMaxDate(i);if(this._oDatesRow){this._oDatesRow._oMaxDate=i;this._oDatesRow.invalidate()}if(this._oWeeksRow){this._oWeeksRow._oMaxDate=i;this._oWeeksRow.invalidate()}if(this._oOneMonthsRow){this._oOneMonthsRow._oMaxDate=i;this._oOneMonthsRow.invalidate()}if(t&&t.getTime()>i.getTime()){$.warning("maxDate < minDate -> maxDate set to begin of the month",this);t=i;t.setDate(1);t.setHours(0);t.setMinutes(0);t.setSeconds(0);t.setMilliseconds(0);this.setMinDate(t)}this._bNoStartDateChange=undefined;var s=this.getStartDate();if(s&&s.getTime()>i.getTime()){$.warning("StartDate > maxDate -> StartDate set to minDate",this);if(t){s=V.getInstance(t.getTime())}else{s=V.getInstance(1,0,1);s.setFullYear(1)}this.setStartDate(s);a.updatePickerText(this._formatPickerText())}}else{this.setProperty("maxDate",undefined,true);a.getAggregation("_calendarPicker").setMaxDate();a.getAggregation("_monthPicker").setMaxDate();a.getAggregation("_yearPicker").setMaxDate()}var r=V.getInstance();if(e&&r.getTime()>i.getTime()){this._oTodayButton.setVisible(false)}else if(!t||r.getTime()>t.getTime()){this._oTodayButton.setVisible(true)}if(this.getDomRef()){this._updatePickerSelection();this._updateHeaderButtons()}return this};pe.prototype._setCalendarWeekNumbering=function(){var e=this.getCalendarWeekNumbering(),t=this._getHeader(),a=t._oPopup&&t._oPopup.getContent()[0],i;this._updateWeekConfiguration();t.setCalendarWeekNumbering(e);a&&a.setCalendarWeekNumbering(e);for(i in ue){this[ue[i].sInstanceName]&&this[ue[i].sInstanceName].setCalendarWeekNumbering(e)}this._oCalendarWeeks?.setCalendarWeekNumbering(e)};pe.prototype.removeIntervalInstanceFromInfoToolbar=function(){var e=this._oInfoToolbar.getContent();e.forEach(function(e){if(e.isA(Ce)){this._oInfoToolbar.removeContent(e)}}.bind(this))};pe.prototype.isRelative=function(){var e=this._getView(this.getViewKey(),true);if(!e){return false}return e.getRelative()};pe.prototype.setViewKey=function(e){var t,a,i,n=this.getViewKey(),s=this._getHeader(),r,h,g;this.setProperty("viewKey",e,true);this._oIntervalTypeSelect.setSelectedKey(e);this.removeIntervalInstanceFromInfoToolbar();var u=this.getStartDate();var f=this.getMinDate();var _=this.getMaxDate();var y=this._getView(e,!this._bBeforeRendering);var m;var D=this._getSecondaryCalendarType();if(!y){this._bCheckView=true;this.invalidate()}else{var v=y.getIntervalType();var w=y.getIntervalSize();var C=this._getIntervals(y);this._bCheckView=false;this._dateNav.setUnit(v);this._dateNav.setStep(C*w);this._dateNav.setCurrent(undefined);switch(v){case ne.Hour:if(!this._oTimesRow){this._oTimesRow=new p(this.getId()+"-TimesRow",{startDate:V.getInstance(u.getTime()),items:C,legend:this.getLegend()});this._setAriaRole(this._oTimesRow);this._oTimesRow._setLegendControlOrigin(this);this._oTimesRow.attachEvent("focus",this._handleFocus,this);this._oTimesRow.attachEvent("select",this._handleCalendarSelect,this);this._oTimesRow._oPlanningCalendar=this;this._oTimesRow._getSpecialDates=function(){return this._oPlanningCalendar._getSpecialDates()};this._oTimesRow.getSpecialDates=function(){return this._oPlanningCalendar.getSpecialDates()}}else if(this._oTimesRow.getItems()!==C){this._oTimesRow.setItems(C);this._dateNav.setStep(C*w)}this._insertInterval(this._oTimesRow);m=s.getAggregation("_calendarPicker")?s.getAggregation("_calendarPicker"):s._oPopup.getContent()[0];m.addDelegate(De,m);s.setAssociation("currentPicker",m);break;case ne.Day:case ne.Week:case ne.OneMonth:case"OneMonth":if(u&&f&&u.getTime()<=f.getTime()){if(e===ne.Week){var S=this._getWeekConfigurationValues(),T=o.getFirstDateOfWeek(o._createUniversalUTCDate(f,undefined,true),S),R=o._createLocalDate(T,true);u=V.getInstance(R.getTime())}else if(this._isOneMonthView(e)&&this._iSize&&this._iSize===2){h=o._getFirstDateOfMonth(l.fromLocalJSDate(f,this._getPrimaryCalendarType()));g=h.toLocalJSDate();u=V.getInstance(g.getTime())}else{u=V.getInstance(f.getTime())}this.setStartDate(u)}i=ue[v];t=this[i.sInstanceName];if(!t){t=new i.oClass(this.getId()+i.sIdSuffix,{startDate:V.getInstance(u.getTime()),days:C,showDayNamesLine:this.getShowDayNamesLine(),legend:this.getLegend(),showWeekNumbers:this.getShowWeekNumbers(),calendarWeekNumbering:this.getCalendarWeekNumbering()});t.isRelative=this.isRelative.bind(this);t._getRelativeInfo=this._getRelativeInfo.bind(this);this._setAriaRole(t);t.attachEvent("select",this._handleCalendarSelect,this);t.attachEvent("focus",this._handleFocus,this);if(this._isOneMonthView(e)){t._setRowsStartDate=this._setRowsStartDate.bind(this)}t._oMinDate=f;t._oMaxDate=_;t._oPlanningCalendar=this;t._getSpecialDates=function(){return this._oPlanningCalendar._getSpecialDates()};t.getSpecialDates=function(){return this._oPlanningCalendar.getSpecialDates()}}else if(t.getDays()!==C){t.setDays(C);this._dateNav.setStep(C*w)}this._insertInterval(t);this[i.sInstanceName]=t;if(v===ne.OneMonth||v==="OneMonth"){m=s.getAggregation("_monthPicker")?s.getAggregation("_monthPicker"):s._oPopup.getContent()[0];s.setAssociation("currentPicker",m);m.addDelegate(ve,m)}else if(this.isRelative()){var A=s.getAggregation("_indexPicker");m=A?A:s._oPopup.getContent()[0];if(A){var y=this._getView(e);var I=Math.round(this.calcIntervalOffset(u));A.setFormatter(this._getRelativeInfo().intervalLabelFormatter);A.setPeriodSize(t.getDays());A.setSelectedIndex(I)}else{var y=this._getView(e);m.setFormatter(y.getIntervalLabelFormatter());m.setPeriodSize(t.getDays());var I=Math.round(this.calcIntervalOffset(u));m.setSelectedIndex(I)}s.setAssociation("currentPicker",m)}else{m=s.getAggregation("_calendarPicker")?s.getAggregation("_calendarPicker"):s._oPopup.getContent()[0];s.setAssociation("currentPicker",m);m.addDelegate(De,m)}if(!this._oCalendarWeeks){this._oCalendarWeeks=new c(this.getId()+"-CalendarWeeksRow",{startDate:this.getStartDate(),primaryCalendarType:this.getPrimaryCalendarType(),interval:C,viewKey:e,showWeekNumbers:this.getShowWeekNumbers(),calendarWeekNumbering:this.getCalendarWeekNumbering()})}else{this._oCalendarWeeks.setInterval(C);this._oCalendarWeeks.setShowWeekNumbers(this.getShowWeekNumbers());this._oCalendarWeeks.setPrimaryCalendarType(this.getPrimaryCalendarType());this._oCalendarWeeks.setStartDate(this.getStartDate());this._oCalendarWeeks.setViewKey(e)}this._oInfoToolbar.addContent(this._oCalendarWeeks);break;case ne.Month:if(!this._oMonthsRow){this._oMonthsRow=new d(this.getId()+"-MonthsRow",{startDate:V.getInstance(u.getTime()),months:C,legend:this.getLegend(),showWeekNumbers:this.getShowWeekNumbers()});this._oMonthsRow.setProperty("primaryCalendarType",this._getPrimaryCalendarType());if(D){this._oMonthsRow.setProperty("secondaryCalendarType",D)}this._setAriaRole(this._oMonthsRow);this._oMonthsRow._setLegendControlOrigin(this);this._oMonthsRow.attachEvent("focus",this._handleFocus,this);this._oMonthsRow.attachEvent("select",this._handleCalendarSelect,this);this._oMonthsRow._oPlanningCalendar=this;this._oMonthsRow._getSpecialDates=function(){return this._oPlanningCalendar._getSpecialDates()};this._oMonthsRow.getSpecialDates=function(){return this._oPlanningCalendar.getSpecialDates()}}else if(this._oMonthsRow.setMonths()!==C){this._oMonthsRow.setMonths(C);this._dateNav.setStep(C*w)}this._insertInterval(this._oMonthsRow);m=s.getAggregation("_yearPicker")?s.getAggregation("_yearPicker"):s._oPopup.getContent()[0];s.setAssociation("currentPicker",m);m.addDelegate(we,m);if(!this._oCalendarWeeks){this._oCalendarWeeks=new c(this.getId()+"-CalendarWeeksRow",{startDate:this.getStartDate(),primaryCalendarType:this.getPrimaryCalendarType(),interval:C,viewKey:ne.Month,showWeekNumbers:this.getShowWeekNumbers(),calendarWeekNumbering:this.getCalendarWeekNumbering()})}else{this._oCalendarWeeks.setInterval(C);this._oCalendarWeeks.setShowWeekNumbers(this.getShowWeekNumbers());this._oCalendarWeeks.setPrimaryCalendarType(this.getPrimaryCalendarType());this._oCalendarWeeks.setStartDate(this.getStartDate());this._oCalendarWeeks.setViewKey(ne.Month)}this._oInfoToolbar.addContent(this._oCalendarWeeks);break;default:throw new Error("Unknown IntervalType: "+v+"; "+this)}var M=this.getAggregation("table").getInfoToolbar().getContent()[1];if(M.getMetadata().hasProperty("_primaryCalendarType")){M.setProperty("_primaryCalendarType",this._getPrimaryCalendarType())}else if(M.getMetadata().hasProperty("primaryCalendarType")){M.setPrimaryCalendarType(this._getPrimaryCalendarType())}if(D&&M.getMetadata().hasProperty("_secondaryCalendarType")){M.setProperty("_secondaryCalendarType",D)}else if(D&&M.getMetadata().hasProperty("secondaryCalendarType")){M.setSecondaryCalendarType(D)}if(this._oOneMonthsRow){this._oOneMonthsRow.setPrimaryCalendarType(this._getPrimaryCalendarType())}if(M.setFirstDayOfWeek){M.setFirstDayOfWeek(this.getFirstDayOfWeek())}var k=this.getRows();for(var b=0;b<k.length;b++){var P=k[b];var H=Ue(P);H.setIntervalType(v);H.setIntervals(C);H.setIntervalSize(w);H.setShowSubIntervals(y.getShowSubIntervals())}if(this.getDomRef()){this._updateCurrentTimeVisualization(false);Ae.call(this,this.getShowWeekNumbers(),this._viewAllowsWeekNumbers(e));Ie.call(this,this.getShowDayNamesLine(),!!t)}this._updatePickerSelection()}if(this._isWeekOrOneMonthView(e)||e===ee.Month){a=this.getStartDate();this.setStartDate(V.getInstance(a.getTime()));if(a.getTime()!==this.getStartDate().getTime()){this.fireStartDateChange()}}if(this._oOneMonthsRow&&this._isOneMonthView(e)){this._oOneMonthsRow.setMode(this._iSize);this._adjustSelectedDate(l.fromLocalJSDate(u,this._getPrimaryCalendarType()));if(this._iSize<2){this._setRowsStartDate(u)}}else if(this._oOneMonthsRow&&this._isOneMonthView(n)&&this._oOneMonthsRow.getSelectedDates().length){r=this._oOneMonthsRow.getSelectedDates()[0].getStartDate();if(r){r.setHours(r.getHours());r.setMinutes(r.getMinutes());r.setSeconds(r.getSeconds());r.setMilliseconds(r.getMilliseconds());this.setStartDate(r)}}if(f){s.getAggregation("_calendarPicker")&&s.getAggregation("_calendarPicker").setMinDate(V.getInstance(f.getTime()));s.getAggregation("_yearPicker")&&s.getAggregation("_yearPicker").setMinDate(V.getInstance(f.getTime()));s.getAggregation("_monthPicker")&&s.getAggregation("_monthPicker").setMinDate(V.getInstance(f.getTime()))}if(_){s.getAggregation("_calendarPicker")&&s.getAggregation("_calendarPicker").setMaxDate(V.getInstance(_.getTime()));s.getAggregation("_yearPicker")&&s.getAggregation("_yearPicker").setMaxDate(V.getInstance(_.getTime()));s.getAggregation("_monthPicker")&&s.getAggregation("_monthPicker").setMaxDate(V.getInstance(_.getTime()))}this._updateTodayButtonState();this._updateHeaderButtons();return this};pe.prototype._setFirstDayOfWeek=function(){const e=this.getFirstDayOfWeek();if(e<-1||e>6){$.error(""+e+" is not a valid value to the property firstDayOfWeek. Valid values are from -1 to 6.");return}const t=this._getHeader().getAssociation("currentPicker"),a=v.getElementById(t),i=this.getViewKey(),n=this._dateNav,s=n.getStart(),r=this.getStartDate().getDay(),l=i===ee.OneMonth&&this._iSize<2;let h=e,g,d,p;if(a.setFirstDayOfWeek){a.setFirstDayOfWeek(e)}if(i===ee.Week||l){g=this.getAggregation("table").getInfoToolbar().getContent()[1];if(e===-1){d=o.getFirstDateOfWeek(o._createUniversalUTCDate(s,undefined,true));p=o._createLocalDate(d,true);h=p.getDay()}g.setFirstDayOfWeek(e);if(!l){s.setDate(s.getDate()-r+h);g.setStartDate(s)}this.getRows().forEach(function(e){this._updateRowTimeline(e)}.bind(this))}this._updateWeekConfiguration()};pe.prototype._updateWeekConfiguration=function(){var e=this._getWeekConfigurationValues();this._dateNav.setWeekConfiguration(e);this.setStartDate(this._dateNav.getStart())};pe.prototype._getWeekConfigurationValues=function(){var t=new P(e.getLanguageTag()).toString(),a=this.getCalendarWeekNumbering(),i=this.getFirstDayOfWeek(),n=b.getWeekConfigurationValues(a,new P(t));if(i>-1){n.firstDayOfWeek=i}return n};pe.prototype._handleFocus=function(e){var t=e.getParameter("date"),a=e.getParameter("restoreOldDate");if(a){return}this.shiftToDate(t,e.getParameter("otherMonth"));this._addMonthFocusDelegate(this._getRowInstanceByViewKey(this.getViewKey()))};pe.prototype.shiftToDate=function(e,t){var a=this._getRowInstanceByViewKey(this.getViewKey()),i,n;this._dateNav.toDate(e,this._getPrimaryCalendarType());i=this._dateNav.getStart();n=this._dateNav.getCurrent();if(this._dateNav.getCurrent()>this._dateNav.getEnd()){i=V.getInstance(this._dateNav.getStart());i.setDate(i.getDate()+1)}if(this.getMaxDate()&&this.getMaxDate()<e||this.getMinDate()&&this.getMinDate()>e){return}if(t){this.fireStartDateChange()}if(a&&!(a.getMode&&a.getMode()<2&&!t)){this.setStartDate(i);a.setStartDate(i);a.setDate(n);this._addMonthFocusDelegate(a)}};pe.prototype._addMonthFocusDelegate=function(e){var t={onAfterRendering:function(){this._oItemNavigation.focusItem(this._oItemNavigation.getFocusedIndex());this.removeDelegate(t)}};e.addDelegate(t,e)};pe.prototype._shiftStartDate=function(e){if(this.getViewKey()===ee.Week){var t=this._getWeekConfigurationValues(),a=o.getFirstDateOfWeek(o._createUniversalUTCDate(e,undefined,true),t),i=o._createLocalDate(a,true);if(this.getFirstDayOfWeek()>-1){i.setDate(i.getDate()-i.getDay()+this.getFirstDayOfWeek())}if(i.getTime()>e.getTime()){i.setDate(i.getDate()-7)}e.setTime(i.getTime())}if(this.getViewKey()===ee.OneMonth||this.getViewKey()===ee.Month||this.getViewKey()==="OneMonth"){var n=o._getFirstDateOfMonth(l.fromLocalJSDate(e,this._getPrimaryCalendarType()));var s=n.toLocalJSDate();s.setHours(e.getHours(),e.getMinutes(),e.getSeconds());e.setTime(s.getTime())}return e};pe.prototype._updatePickerSelection=function(){var e=this._getFirstAndLastRangeDate(),t=this._getHeader().getAssociation("currentPicker"),a=v.getElementById(t),i;i=new u({startDate:o._createLocalDate(e.oStartDate,true),endDate:o._createLocalDate(e.oEndDate,true)});if(this.isRelative()){a.setStartIndex(this.calcIntervalOffset(e.oStartDate))}else{a.destroySelectedDates();a.addSelectedDate(i)}this._getHeader().updatePickerText(this._formatPickerText());this._updateTodayButtonState()};pe.prototype._adjustSelectedDate=function(e){var t=e.toLocalJSDate(),a=this.getMinDate();if(a&&t.getTime()<a.getTime()){t=V.getInstance(a.getTime())}if(this._oOneMonthsRow.getMode&&this._oOneMonthsRow.getMode()<2){this._oOneMonthsRow.removeAllSelectedDates();this._oOneMonthsRow.addSelectedDate(new u({startDate:t}));this._oOneMonthsRow.selectDate(t)}};pe.prototype._insertInterval=function(e){if(this._iSizeScreen>1){this._oInfoToolbar.addContent(e)}else{this._oInfoToolbar.insertContent(e,1)}};pe.prototype._viewAllowsWeekNumbers=function(e){var t=this._getView(e).getIntervalType(),a=ue[t];return!!a&&!!a.oClass.prototype.setShowWeekNumbers};pe.prototype._viewAllowsDayNamesLine=function(e){var t=this._getView(e).getIntervalType(),a=ue[t];return!!a&&!!a.oClass.prototype.setShowDayNamesLine};pe.prototype._getRowInstanceByViewKey=function(e){var t=this._getView(e).getIntervalType(),a=ue[t],i;if(a){i=this[a.sInstanceName]}if(t===ne.Month){i=this._oMonthsRow}if(t===ne.Hour){i=this._oTimesRow}return i};pe.prototype._setShowWeekNumbers=function(){const e=this.getShowWeekNumbers();this._getViews().forEach(function(t){var a=t.getKey(),i=this._viewAllowsWeekNumbers(a),n=this._getRowInstanceByViewKey(a);if(n&&i){n.setShowWeekNumbers(e)}if(this.getDomRef()&&this.getViewKey()===a){Ae.call(this,e,i)}},this);if(this._oCalendarWeeks){this._oCalendarWeeks.setShowWeekNumbers(e)}if(this._oMonthsRow){this._oMonthsRow.setShowWeekNumbers(e)}};pe.prototype._setShowRowHeaders=function(){const e=this.getShowRowHeaders();var t=this.getAggregation("table"),a,i;t.getColumns()[0].setVisible(e);this._toggleAppointmentsColumnPopinState(e);this.$().toggleClass("sapMPlanCalNoHead",!e);$e.call(this);this._setSelectionMode.call(this);t.getItems().forEach(function(t){a=t.getCells()[0];i=t.getCells()[1];if(e){i.addAriaLabelledBy(a.getId())}else{i.removeAriaLabelledBy(a.getId())}});return this};pe.prototype._setShowDayNamesLine=function(){var e,t,a,i=!!this.getDomRef(),n=this.getViewKey(),s=this.getShowDayNamesLine();for(e in ue){t=ue[e].sInstanceName;if(this[t]){a=this[t];a.setShowDayNamesLine(s);if(i&&e===n){Ie.call(this,s,true)}}}};pe.prototype._setStickyHeader=function(){const e=this.getStickyHeader();if(D.system.phone){if(e){D.orientation.attachHandler(this._updateStickyHeader,this)}else{D.orientation.detachHandler(this._updateStickyHeader,this)}}this._updateStickyHeader()};pe.prototype._updateStickyHeader=function(){var e=[],t=this.getStickyHeader(),a=this._isOneMonthView(this.getViewKey())&&this._iSize<2,i=t&&!D.system.phone&&!a,n=t&&!(D.system.phone&&D.orientation.landscape)&&!a;if(i){e.push(q.HeaderToolbar)}if(this._oInfoToolbar&&n){e.push(q.InfoToolbar)}this.getAggregation("table").setSticky(e)};pe.prototype._adjustViewKey=function(){if(!this._oTimesRow&&!this._oDatesRow&&!this._oMonthsRow&&!this._oWeeksRow&&!this._oOneMonthsRow||this._bCheckView){this.setViewKey(this.getViewKey());this._bCheckView=undefined}};pe.prototype.addView=function(e){this.addAggregation("views",e);if(e.getKey()===this.getViewKey()){this._adjustViewKey()}return this};pe.prototype.insertView=function(e,t){this.insertAggregation("views",e,t);if(e.getKey()===this.getViewKey()){this._adjustViewKey()}return this};pe.prototype.addRow=function(e){this.addAggregation("rows",e);this.getAggregation("table").addItem(this._createPlanningCalendarListItem(e));return this};pe.prototype.insertRow=function(e,t){this.insertAggregation("rows",e,t);this.getAggregation("table").insertItem(this._createPlanningCalendarListItem(e),t,true);return this};pe.prototype.removeRow=function(e){var t=this.removeAggregation("rows",e,true),a=this.getAggregation("table");a.removeItem(Ee(t),true);this._handleRowRemoval(t);Ye.call(this);this._setSelectionMode.call(this);return t};pe.prototype.removeAllRows=function(){var e=this.removeAllAggregation("rows",true),t=this.getAggregation("table");t.removeAllItems(true);e.forEach(this._handleRowRemoval,this);Ye.call(this);this._setSelectionMode.call(this);return e};pe.prototype.destroyRows=function(){var e;var t=this.getAggregation("table");t.destroyItems(true);e=this.destroyAggregation("rows");Ye.call(this);this._setSelectionMode.call(this);return e};pe.prototype.setSingleSelection=function(e){this.setProperty("singleSelection",e,true);$e.call(this);this._setSelectionMode.call(this);if(e){this.selectAllRows(false)}else{Ye.call(this)}this.$().toggleClass("sapMPlanCalMultiSel",!e);return this};pe.prototype._setNoDataText=function(){const e=this.getNoDataText(),t=this.getAggregation("table");t.setNoDataText(e)};pe.prototype._setLegend=function(e){const t=e&&v.getElementById(e);let a;ce.forEach(function(t){if(this[t]){this[t].setLegend(e)}},this);if(t){a=new n(function(e){this.invalidate()}.bind(this));a.observe(t,{destroy:true})}};pe.prototype.addAriaLabelledBy=function(e){this.addAssociation("ariaLabelledBy",e,true);var t=this.getAggregation("table");t.addAriaLabelledBy(e);return this};pe.prototype.removeAriaLabelledBy=function(e){this.removeAssociation("ariaLabelledBy",e,true);var t=this.getAggregation("table");t.removeAriaLabelledBy(e);return this};pe.prototype.removeAllAriaLabelledBy=function(){const e=this.getAggregation("header");const t=e?.getTitle();this.removeAllAssociation("ariaLabelledBy",true);this._resetTableLabelledBy(t);return this};pe.prototype._resetTableLabelledBy=function(e){const t=this.getAggregation("table"),a=e?.getId()||"",i=`${this.getId()}-Descr`;t.removeAllAriaLabelledBy();t.addAriaLabelledBy(`${i} ${a}`.trim())};pe.prototype.invalidate=function(e){var t=e&&e instanceof u;if(!this._bIsBeingDestroyed&&(this._bDateRangeChanged||t)){if(this.getDomRef()){var a=this.getViewKey();var n=this._getView(a);var s=n.getIntervalType();switch(s){case ne.Hour:if(this._oTimesRow){this._oTimesRow.invalidate(arguments)}break;case ne.Day:if(this._oDatesRow){this._oDatesRow.invalidate(arguments)}break;case ne.Month:if(this._oMonthsRow){this._oMonthsRow.invalidate(arguments)}break;case ne.OneMonth:case"OneMonth":if(this._oOneMonthsRow){this._oOneMonthsRow.invalidate(arguments)}break;case ne.Week:if(this._oWeeksRow){this._oWeeksRow.invalidate(arguments)}break;default:throw new Error("Unknown IntervalType: "+s+"; "+this)}}this._bDateRangeChanged=undefined}else{if(e instanceof F){this._bCheckView=true}i.prototype.invalidate.apply(this,arguments)}};pe.prototype.addSpecialDate=function(e){this._bDateRangeChanged=true;return i.prototype.addAggregation.call(this,"specialDates",e)};pe.prototype.insertSpecialDate=function(e,t){this._bDateRangeChanged=true;return i.prototype.insertAggregation.call(this,"specialDates",e,t)};pe.prototype.removeSpecialDate=function(e){this._bDateRangeChanged=true;return i.prototype.removeAggregation.call(this,"specialDates",e)};pe.prototype.removeAllSpecialDates=function(){this._bDateRangeChanged=true;return this.removeAllAggregation("specialDates")};pe.prototype.destroySpecialDates=function(){this._bDateRangeChanged=true;return this.destroyAggregation("specialDates")};pe.prototype.removeAllViews=function(){this._bCheckView=true;var e=this.removeAllAggregation("views"),t=this.getBuiltInViews();if(t.length){this.setViewKey(t[0])}else{this.setViewKey(_e[0])}return e};pe.prototype.destroyViews=function(){this._bCheckView=true;var e=this.destroyAggregation("views"),t=this.getBuiltInViews();if(t.length){this.setViewKey(t[0])}else{this.setViewKey(_e[0])}return e};pe.prototype.getSelectedRows=function(){return this.getRows().filter(function(e){return e.getSelected()})};pe.prototype.selectAllRows=function(e){var t=this.getRows();if(!(e&&this.getSingleSelection())){for(var a=0;a<t.length;a++){var i=t[a];i.setSelected(e)}if(this._oSelectAllCheckBox){this._oSelectAllCheckBox.setSelected(e)}}return this};pe.prototype.onsaphomemodifiers=function(e){if((e.metaKey||e.ctrlKey)&&!e.altKey&&!e.shiftKey){var t=this.getRows();var a=t[0];var i=new jQuery.Event("saphome");i._bPlanningCalendar=true;Ue(a).onsaphome(i);e.preventDefault();e.stopPropagation()}};pe.prototype.onsapendmodifiers=function(e){if((e.metaKey||e.ctrlKey)&&!e.altKey&&!e.shiftKey){var t=this.getRows();var a=t[t.length-1];var i=new jQuery.Event("sapend");i._bPlanningCalendar=true;Ue(a).onsapend(i);e.preventDefault();e.stopPropagation()}};pe.prototype.setBuiltInViews=function(e){this.setProperty("builtInViews",e);this.setViewKey(this._getViews()[0].getKey());return this};pe.prototype.removeView=function(e){var t=this.removeAggregation("views",e);if(!this.getViews().length){this.setViewKey(this._getViews()[0].getKey())}return t};pe.prototype._isOneMonthView=function(e){return e===ee.OneMonth||e==="OneMonth"};pe.prototype._isWeekOrOneMonthView=function(e){return e===ee.Week||this._isOneMonthView(e)};pe.prototype._getIntervals=function(e){var t=0;switch(this._iSize){case 0:t=e.getIntervalsS();break;case 1:t=e.getIntervalsM();break;default:t=e.getIntervalsL();break}return t};pe.prototype._getView=function(e,t){var a=this._getViews();var i;for(var n=0;n<a.length;n++){i=a[n];if(i.getKey()!=e){i=undefined}else{break}}if(!i&&!t){throw new Error("PlanningCalendarView with key "+e+" not assigned "+this)}return i};pe.prototype._changeStartDate=function(e){if(this._bNoStartDateChange){return}this.setStartDate(V.getInstance(e.getTime()));this._updatePickerSelection();this.fireStartDateChange()};pe.prototype._updateCurrentTimeVisualization=function(e){if(this._sUpdateCurrentTime){clearTimeout(this._sUpdateCurrentTime);this._sUpdateCurrentTime=undefined}if(e){var t=this.getRows();for(var a=0;a<t.length;a++){var i=t[a];Ue(i).updateCurrentTimeVisualization()}}var n=V.getInstance();var s=this.getStartDate();var r=this.getViewKey();var o=this._getView(r);var l=o.getIntervalType();var h=this._getIntervals(o);var g=0;var d=0;var p=0;switch(l){case ne.Hour:g=6e4;d=s.getTime()-36e5;p=s.getTime()+h*36e5;break;case ne.Day:case ne.Week:case ne.OneMonth:case"OneMonth":g=18e5;d=s.getTime()-36e5;p=s.getTime()+h*864e5;break;default:g=-1;break}if(n.getTime()<=p&&n.getTime()>=d&&g>0){this._sUpdateCurrentTime=setTimeout(this["_updateCurrentTimeVisualization"].bind(this,true),g)}};function Te(e){this.setViewKey(e.getParameter("item").getKey());this.fireViewChange()}pe.prototype._handleTodayPress=function(e){var t=V.getInstance(),a,i=this.getViewKey(),n={onAfterRendering:function(){this._focusDate(l.fromLocalJSDate(V.getInstance(),this._getPrimaryCalendarType()));this.removeDelegate(n)}};if(this._isOneMonthView(i)){a=o._getFirstDateOfMonth(l.fromLocalJSDate(t,this._getPrimaryCalendarType()));this._adjustSelectedDate(l.fromLocalJSDate(t,this._getPrimaryCalendarType()));t=a.toLocalJSDate()}if(i===ee.Week){a=this.getStartDate();t.setHours(a.getHours());t.setMinutes(a.getMinutes());t.setSeconds(a.getSeconds())}this.setStartDate(t);this._dateNav.setCurrent(t);if(i===ee.Week){this._oWeeksRow.addDelegate(n,this._oWeeksRow)}else if(this._isOneMonthView(i)){this._oOneMonthsRow.addDelegate(n,this._oOneMonthsRow)}this._updatePickerSelection();this.fireStartDateChange()};pe.prototype._handleStartDateChange=function(e){var t=e.oSource.getStartDate();if(this._getView(this.getViewKey()).getIntervalType()!==ne.Hour){var a=this.getStartDate();t.setHours(a.getHours());t.setMinutes(a.getMinutes());t.setSeconds(a.getSeconds())}this._changeStartDate(t)};pe.prototype._handleDateSelect=function(e){var t,a=this.getStartDate(),i=this.getViewKey(),n=this._getView(i),s=n.getIntervalType(),r;if(this.isRelative()){t=V.getInstance(this.getMinDate().getTime());t.setDate(t.getDate()+e.getSource()._oIndexPicker.getSelectedIndex()*this._getView(this.getViewKey()).getIntervalSize())}else{t=e.getSource().getStartDate()}if(s===ne.Hour){t.setHours(a.getHours());t.setMinutes(a.getMinutes());t.setSeconds(a.getSeconds())}if(a.getTime()!==t.getTime()){this._changeStartDate(t);if(s===ne.Month){t=this.getStartDate()}this._dateNav.setCurrent(t);if(s==="Hour"){s="Time"}else if(s==="Day"){s="Date"}else if(s==="One Month"){s="OneMonth"}r="_o"+s+"sRow";if(this[r]){this[r].displayDate(t)}}};pe.prototype._handleCalendarSelect=function(e){var t=e.getSource().getSelectedDates();if(!t.length){return}var a=V.getInstance(t[0].getStartDate());var i=l.fromLocalJSDate(a,this._getPrimaryCalendarType());var n=o._createUniversalUTCDate(a,this._getPrimaryCalendarType(),true);var s=this.getViewKey();var r=this._getView(s);var h=r.getIntervalType();if(h!==ne.OneMonth&&h!=="OneMonth"||this._iSize>1){t[0].setStartDate()}switch(h){case ne.Hour:n.setUTCHours(n.getUTCHours()+1);break;case ne.Day:case ne.Week:n.setUTCDate(n.getUTCDate()+1);break;case ne.OneMonth:case"OneMonth":if(this._iSize<2){var g=V.getInstance(i.toLocalJSDate().getTime());if(o.monthsDiffer(this.getStartDate(),i.toLocalJSDate())){this.setStartDate(i.toLocalJSDate());this._getHeader().updatePickerText(this._formatPickerText());this.fireStartDateChange()}this._setRowsStartDate(g);this._oOneMonthsRow._focusDate(l.fromLocalJSDate(g,this._getPrimaryCalendarType()),true)}else if(o._isNextMonth(i.toLocalJSDate(),this.getStartDate())){this.shiftToDate(i.toLocalJSDate(),true);this._addMonthFocusDelegate(this._getRowInstanceByViewKey(this.getViewKey()));n.setUTCDate(n.getUTCDate()+1);n.setUTCMilliseconds(n.getUTCMilliseconds()-1);n=o._createLocalDate(n,true);this.fireIntervalSelect({startDate:a,endDate:n,subInterval:false,row:undefined});return}n.setUTCDate(n.getUTCDate()+1);break;case ne.Month:n.setUTCMonth(n.getUTCMonth()+1);break;default:throw new Error("Unknown IntervalType: "+h+"; "+this)}n.setUTCMilliseconds(n.getUTCMilliseconds()-1);n=o._createLocalDate(n,true);this._formatPickerText();this.fireIntervalSelect({startDate:a,endDate:n,subInterval:false,row:undefined})};function Re(e){var t=e.getParameter("startDate");var a=this.getViewKey();var i=this._getView(a);var n=i.getIntervalType();if((n===ne.OneMonth||n==="OneMonth")&&o._isNextMonth(t,this.getStartDate())){this.shiftToDate(t);this._addMonthFocusDelegate(this._getRowInstanceByViewKey(this.getViewKey()));return}var s=e.getParameter("endDate");var r=e.getParameter("subInterval");var l=We(e.oSource.getParent());this._formatPickerText();this.fireIntervalSelect({startDate:t,endDate:s,subInterval:r,row:l})}pe.prototype._applyContextualSettings=function(e){return i.prototype._applyContextualSettings.call(this,e)};function Ae(e,t){this.$().toggleClass("sapMPlanCalWithWeekNumbers",e&&t)}function Ie(e,t){this.$().toggleClass("sapMPlanCalWithDayNamesLine",e&&t)}function Me(e,t){if(e.size.width<=0){return}if(Math.abs(this.iWidth-e.size.width)<15){return}this.iWidth=e.size.width;this._applyContextualSettings({contextualWidth:this.iWidth});this._getHeader()._updateViewSwitchLabelFor();var a=this.getRows();var i;var n=0;var s;var r=this._iSize;ze.call(this,e.size.width);if(r!=this._iSize){Ke.call(this,this._iSize);var o=this.getViewKey();var h=this._getView(o);var g=h.getIntervalType();var d=h.getIntervalSize();var p=this._getIntervals(h);for(n=0;n<a.length;n++){i=a[n];var c=Ue(i);if(p!=c.getIntervals()){c.setIntervals(p)}else{c.handleResize()}}switch(g){case ne.Hour:if(this._oTimesRow&&this._oTimesRow.getItems()!=p){this._oTimesRow.setItems(p);this._dateNav.setStep(p*d)}break;case ne.Day:if(this._oDatesRow&&this._oDatesRow.getDays()!=p){this._oDatesRow.setDays(p);this._dateNav.setStep(p*d)}this._oCalendarWeeks?.setInterval(p);break;case ne.Month:if(this._oMonthsRow&&this._oMonthsRow.getMonths()!=p){this._oMonthsRow.setMonths(p);this._dateNav.setStep(p*d)}this._oCalendarWeeks?.setInterval(p);break;case ne.Week:if(this._oWeeksRow&&this._oWeeksRow.getDays()!=p){this._oWeeksRow.setDays(p);this._dateNav.setStep(p*d)}this._oCalendarWeeks?.setInterval(p);break;case ne.OneMonth:case"OneMonth":if(this._oOneMonthsRow&&this._oOneMonthsRow.getDays()!=p){this._oOneMonthsRow.setDays(p);this._dateNav.setStep(p*d);if(this._iSize>1){this._setRowsStartDate(V.getInstance(this.getStartDate().getTime()))}}this._oCalendarWeeks?.setInterval(p);break;default:throw new Error("Unknown IntervalType: "+g+"; "+this)}$e.call(this);this._updatePickerSelection()}else if(!t){for(n=0;n<a.length;n++){i=a[n];Ue(i).handleResize()}}if(this._oOneMonthsRow&&(this.getViewKey()===ne.OneMonth||this.getViewKey()==="OneMonth")){s=this._getSelectedDates().length&&this._getSelectedDates()[0].getStartDate()?this._getSelectedDates()[0].getStartDate():this.getStartDate();this._oOneMonthsRow.setMode(this._iSize);this._adjustSelectedDate(l.fromLocalJSDate(s,this._getPrimaryCalendarType()))}if(this.getStickyHeader()){this._adjustColumnHeadersTopOffset();this._updateStickyHeader()}}function ke(e){var t=e.getParameter("appointment"),a=e.getParameter("multiSelect")||this.getMultipleAppointmentsSelection(),i=e.getParameter("appointments"),n=e.getParameter("domRefId"),s,r,o,l,h,g,d;if(!a){r=this.getRows();for(g=0;g<r.length;g++){o=r[g];if(e.oSource!=Ue(o)){l=o.getAppointments();for(d=0;d<l.length;d++){h=l[d];h.setSelected(false)}}}}s={appointment:t,appointments:i,multiSelect:a,domRefId:n};this.fireAppointmentSelect(s)}pe.prototype._setRowsStartDate=function(e){var t=this.getRows(),a,i;for(i=0;i<t.length;i++){a=t[i];Ue(a).setStartDate(e)}};pe.prototype._toggleAppointmentsColumnPopinState=function(e){var t=this.getAggregation("table"),a=t.getColumns()[1];a.setDemandPopin(e);a.setMinScreenWidth(e?fe:"")};pe.prototype._getViews=function(){var e=this.getViews(),t=this.getBuiltInViews(),a,i=[],n=ee,s=ne;if(!this._oViews){this._oViews={}}if(t.length){i=t}else{i=e.length?[]:_e}a=i.map(function(e){switch(e){case n.Hour:if(!this._oViews[n.Hour]){this._oViews[n.Hour]=new F(this.getId()+"-HourView",{key:n.Hour,intervalType:s.Hour,description:this._oRB&&this._oRB.getText("PLANNINGCALENDAR_HOURS"),intervalsS:6,intervalsM:6,intervalsL:12})}return this._oViews[n.Hour];case n.Day:if(!this._oViews[n.Day]){this._oViews[n.Day]=new F(this.getId()+"-DayView",{key:n.Day,intervalType:s.Day,description:this._oRB&&this._oRB.getText("PLANNINGCALENDAR_DAYS"),intervalsS:7,intervalsM:7,intervalsL:14})}return this._oViews[n.Day];case n.Month:if(!this._oViews[n.Month]){this._oViews[n.Month]=new F(this.getId()+"-MonthView",{key:n.Month,intervalType:s.Month,description:this._oRB&&this._oRB.getText("PLANNINGCALENDAR_MONTHS"),intervalsS:3,intervalsM:6,intervalsL:12})}return this._oViews[n.Month];case n.Week:if(!this._oViews[n.Week]){this._oViews[n.Week]=new F(this.getId()+"-WeekView",{key:n.Week,intervalType:s.Week,description:this._oRB&&this._oRB.getText("PLANNINGCALENDAR_WEEK"),intervalsS:7,intervalsM:7,intervalsL:7})}return this._oViews[n.Week];case n.OneMonth:case"OneMonth":if(!this._oViews[n.OneMonth]){this._oViews[n.OneMonth]=new F(this.getId()+"-OneMonthView",{key:n.OneMonth,intervalType:s.OneMonth,description:this._oRB&&this._oRB.getText("PLANNINGCALENDAR_ONE_MONTH"),intervalsS:1,intervalsM:1,intervalsL:31})}return this._oViews[n.OneMonth];default:$.error("Cannot get PlanningCalendar views. Invalid view key "+e);break}},this);for(var r in this._oViews){if(i.indexOf(r)<0){this._oViews[r].destroy();delete this._oViews[r]}}if(e.length){a=a.concat(e)}return a};pe.prototype.getSelectedAppointments=function(){var e=[];this.getRows().filter(function(t){e.push.apply(e,Ue(t).aSelectedAppointments)});return e};pe.prototype.setCustomAppointmentsSorterCallback=function(e){if(typeof e==="function"||e===null||e===undefined){this.getRows().forEach(function(t){Ue(t)._setCustomAppointmentsSorterCallback(e)});this._fnCustomSortedAppointments=e}else{$.warning("Your custom sort function won't be used, but the old one will be preserved.",this)}return this};pe.prototype.getCustomAppointmentsSorterCallback=function(){return this._fnCustomSortedAppointments};pe.prototype._onRowDeselectAppointment=function(){var e=this.getRows();for(var t=0;t<e.length;t++){var a=Ue(e[t]).aSelectedAppointments;for(var i=0;i<a.length;i++){var n=v.getElementById(a[i]);if(n){var s=n.getColor(),r,o,l;n.setProperty("selected",false,true);n.$().removeClass("sapUiCalendarAppSel");if(!s){continue}r=n._getCSSColorForBackground(s);o=n.getDomRef();if(o){l=o.querySelector(".sapUiCalendarAppCont");if(l){l.style.backgroundColor=r}}}}Ue(e[t]).aSelectedAppointments=[]}};pe.prototype._updateRowTimeline=function(e){var t=Ue(e),a=this.getViewKey(),i,n,s,r,o=this._isOneMonthView(a)&&this._iSize<2,l=this.getStartDate();t.setNonWorkingDays(e.getNonWorkingDays());t.setNonWorkingHours(e.getNonWorkingHours());if(o&&this._oOneMonthsRow&&this._oOneMonthsRow.getSelectedDates().length){l=this._oOneMonthsRow.getSelectedDates()[0].getStartDate()}t.setStartDate(l);t.setShowIntervalHeaders(this.getShowIntervalHeaders());t.setShowEmptyIntervalHeaders(this.getShowEmptyIntervalHeaders());t.setGroupAppointmentsMode(this.getGroupAppointmentsMode());t.setProperty("appointmentsReducedHeight",this.getAppointmentsReducedHeight());t.setAppointmentRoundWidth(this.getAppointmentRoundWidth());t.setLegend(this.getLegend());t.setAppointmentsVisualization(this.getAppointmentsVisualization());t.setAppointmentHeight(this.getAppointmentHeight());t.detachEvent("select",ke,this).attachEvent("select",ke,this);t.detachEvent("startDateChange",this._handleStartDateChange,this).attachEvent("startDateChange",this._handleStartDateChange,this);t.detachEvent("leaveRow",je,this).attachEvent("leaveRow",je,this);t.detachEvent("intervalSelect",Re,this).attachEvent("intervalSelect",Re,this);Ye.call(this);if(Ge.call(this)){a=this.getViewKey();i=this._getView(a);n=i.getIntervalType();r=i.getIntervalSize();s=this._getIntervals(i);t.setIntervalType(n);t.setIntervals(s);t.setIntervalSize(r);t.setShowSubIntervals(i.getShowSubIntervals())}this._setSelectionMode.call(this);if(this._fnCustomSortedAppointments){t._setCustomAppointmentsSorterCallback(this._fnCustomSortedAppointments)}};pe.prototype._observeRowChanges=function(e){var t=Ee(e),a=Le(e),i=Ue(e);var s={destroy:function(){t.destroy()},change:{title:function(e){a.setProperty(e.name,e.current)},icon:function(e){if(a.setIcon){a.setIcon(e.current)}else{a.setProperty(e.name,e.current)}a.getAvatar()&&a.getAvatar().setSrc(e.current).setVisible(!!e.current)},text:function(e){i.toggleStyleClass("sapMPlanCalRowLarge",!!e.current);a.setProperty("description",e.current)},enableAppointmentsDragAndDrop:function(t){this._enableAppointmentsDragAndDrop(e)}.bind(this),enableAppointmentsResize:function(t){this._enableAppointmentsResize(e)}.bind(this),enableAppointmentsCreate:function(t){this._enableAppointmentsCreate(e)}.bind(this),nonWorkingDays:function(e){i.setProperty(e.name,e.current)},nonWorkingHours:function(e){i.setProperty(e.name,e.current)},selected:function(e){Ye.call(this);t.setProperty(e.name,e.current)}.bind(this),tooltip:function(e){if(e.mutation==="insert"){a.setTooltip(e.child)}else if(e.mutation==="remove"){a.setTooltip()}},intervalHeaders:function(e){i.invalidate()},appointments:function(e){i.invalidate()},nonWorkingPeriods:function(e){i.invalidate()}}};new n(function(e){if(e.type==="destroy"){s.destroy()}else if(s.change[e.name]){s.change[e.name](e)}}).observe(e,{properties:["icon","text","title","nonWorkingDays","nonWorkingHours","selected","enableAppointmentsDragAndDrop","enableAppointmentsResize","enableAppointmentsCreate"],aggregations:["tooltip","appointments","nonWorkingPeriods","intervalHeaders","headerContent"],destroy:true});e.invalidate=function(e){if(!e||!(e instanceof _)){v.prototype.invalidate.apply(this,arguments)}else if(t){i.invalidate(e)}};e.applyFocusInfo=function(e){i.applyFocusInfo(e);return this}};pe.prototype._createPlanningCalendarListItem=function(e){var t,a,i,n=e.getIcon();if(e.getHeaderContent().length||e.getBindingInfo("headerContent")){a=e._getPlanningCalendarCustomRowHeader()}else{a=new be(e.getId()+"-Head",{avatar:new O({src:n,displayShape:this.getIconShape(),visible:!!n}),icon:n,description:e.getText(),title:e.getTitle(),tooltip:e.getTooltip(),iconDensityAware:false,iconInset:false})}i=new Ve(e.getId()+"-CalRow",{checkResize:false,updateCurrentTime:false});if(this.getShowRowHeaders()){i.addAriaLabelledBy(a.getId())}i._getRelativeInfo=this._getRelativeInfo.bind(this);i.getAppointments=function(){return e.getAppointments()};i.getNonWorkingPeriods=function(){return e.getNonWorkingPeriods()};i.getIntervalHeaders=function(){return e.getIntervalHeaders()};i.setAssociation("row",e.getId());t=a.isA("sap.m.CustomListItem")?new Oe(e.getId()+de,{cells:[new G({items:[a]}),i]}):new Oe(e.getId()+de,{cells:[a,i]});this._updateRowTimeline(e);this._observeRowChanges(e);this._enableAppointmentsDragAndDrop(e);this._enableAppointmentsResize(e);this._enableAppointmentsCreate(e);return t};pe.prototype._handleRowRemoval=function(e){var t=Ue(e);t.detachEvent("select",ke,this);t.detachEvent("startDateChange",this._handleStartDateChange,this);t.detachEvent("leaveRow",je,this);t.detachEvent("intervalSelect",Re,this);if(this._fnCustomSortedAppointments){t._fnCustomSortedAppointments=undefined}Ee(e).destroy()};var be=x.extend("sap.m._PlanningCalendarRowHeader",{renderer:{apiVersion:2,renderTabIndex:function(e,t){},getAriaRole:function(e,t){}},TagName:"div"});be.prototype.isSelectable=function(){return false};var Pe=w.extend(m);Pe.apiVersion=2;Pe.getLegendItems=function(e){var t=[],a,i=e.getLegend();if(i){a=v.getElementById(i);if(a){t=a.getAppointmentItems?a.getAppointmentItems():a.getItems()}else{$.error("PlanningCalendarLegend with id '"+i+"' does not exist!",e)}}return t};Pe.renderBeforeAppointments=function(e,t){var a=We(t.getParent()),i;if(!a.getEnableAppointmentsDragAndDrop()&&!a.getEnableAppointmentsResize()&&!a.getEnableAppointmentsCreate()||t._isOneMonthsRowOnSmallSizes()){return}i=t.getAggregation("_intervalPlaceholders");e.openStart("div");e.class("sapUiCalendarRowAppsOverlay");e.openEnd();if(i){for(var n=0;n<i.length;n++){var s=i[n];s.setWidth(100/i.length+"%");e.renderControl(s)}}e.close("div")};Pe.renderResizeHandle=function(e,t,a){if(!We(t.getParent()).getEnableAppointmentsResize()||t._isOneMonthsRowOnSmallSizes()||a._aAppointments&&a._aAppointments.length>0){return}e.openStart("span");e.class("sapUiCalendarAppResizeHandle");e.openEnd();e.close("span")};Pe.writeCustomAttributes=function(e,t){if(We(t.getParent()).getEnableAppointmentsCreate()){e.attr("draggable","true")}};var Ve=y.extend("sap.m._PlanningCalendarRowTimeline",{metadata:{aggregations:{intervalHeaders:{type:"sap.ui.unified.CalendarAppointment",multiple:true},_intervalPlaceholders:{type:"sap.m._PlanningCalendarIntervalPlaceholder",multiple:true,visibility:"hidden",dnd:{droppable:true}}},associations:{row:{type:"sap.m.PlanningCalendarRow",multiple:false}},dnd:true},renderer:Pe});Ve.prototype._updatePlaceholders=function(){var e=this.getProperty("intervals");if(this.getIntervalType()===ne.Hour){e*=4}this.removeAllAggregation("_intervalPlaceholders");for(var t=0;t<e;t++){this.addAggregation("_intervalPlaceholders",new He)}};Ve.prototype._getRelativeInfo=function(){};Ve.prototype.onBeforeRendering=function(){y.prototype.onBeforeRendering.call(this);this._updatePlaceholders()};Ve.prototype.onmousedown=function(e){var t=e.target.classList;this._isResizeHandleMouseDownTarget=t.contains("sapUiCalendarAppResizeHandle");this._isRowAppsIntervalMouseDownTarget=t.contains("sapUiCalendarRowAppsInt")};Ve.prototype._isResizingPerformed=function(){return this._isResizeHandleMouseDownTarget};Ve.prototype._isDraggingPerformed=function(){return!this._isResizeHandleMouseDownTarget&&!this._isRowAppsIntervalMouseDownTarget};Ve.prototype._isCreatingPerformed=function(){return this._isRowAppsIntervalMouseDownTarget};Ve.prototype._isNonWorkingInterval=function(e,t,a,i){const n=v.getElementById(this.getAssociation("row")),s=l.fromUTCDate(this._getStartDate().getJSDate()),r=n._getSpecialDates(),o=n.getParent()._getSpecialDates();s.setDate(s.getDate()+e);const h=this._isDateOfType(s,X.Working,r),g=this._isDateOfType(s,X.NonWorking,r),d=this._isDateOfType(s,X.Working,o),p=this._isDateOfType(s,X.NonWorking,o),c=y.prototype._isNonWorkingInterval.call(this,e,t,a,i);return g||p&&!h||c&&!h&&!d};Ve.prototype._isDateOfType=function(e,t,a){let i,n;const s=a.find(function(t){i=t.getStartDate()?l.fromLocalJSDate(t.getStartDate()):l.fromLocalJSDate(t.getEndDate());n=t.getEndDate()?l.fromLocalJSDate(t.getEndDate()):l.fromLocalJSDate(t.getStartDate());return o._isBetween(e,i,n,true)});return Boolean(s)&&(s.getType()===t||s.getSecondaryType()===t)};var He=i.extend("sap.m._PlanningCalendarIntervalPlaceholder",{metadata:{properties:{width:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:null}}},renderer:{apiVersion:2,render(e,t){e.openStart("div",t);e.style("width",t.getWidth());e.class("sapUiCalendarRowAppsPlaceholder");e.openEnd();e.close("div")}}});var Oe=L.extend("sap.m.internal.PlanningCalendarRowListItem",{metadata:{library:"sap.m"},renderer:U});Oe.prototype.getHeader=function(){return this.getCells()[0]};Oe.prototype.getTimeline=function(){return this.getCells()[1]};Oe.prototype.getCustomData=function(){return We(this).getCustomData()};pe.prototype._getSelectedDates=function(){var e=this.getViewKey(),t=this._getView(e),a=t.getIntervalType(),i=ue[a];return this[i.sInstanceName].getSelectedDates()};pe.prototype._enableAppointmentsDragAndDrop=function(e){var t=Ue(e),a;if(e.getEnableAppointmentsDragAndDrop()){a=e.getDragDropConfig().some(function(e){return e.getGroupName()===le});if(!a){this._addDragDropInfo(e,Ue(e))}}else{e.getDragDropConfig().forEach(function(t){if(t.getGroupName()===le){e.removeDragDropConfig(t);t.destroy()}});t.getDragDropConfig().forEach(function(e){if(e.getGroupName()===le){t.removeDragDropConfig(e);e.destroy()}})}};pe.prototype._enableAppointmentsResize=function(e){var t=e.getEnableAppointmentsResize(),a=this._getConfigFromDragDropConfigAggregation(e.getAggregation("dragDropConfig"),he),i;if(t&&!a){i=this._createResizeConfig(e);e.addAggregation("dragDropConfig",i,true)}if(!t&&a){e.removeAggregation("dragDropConfig",a,true);a.destroy()}};pe.prototype._enableAppointmentsCreate=function(e){var t=e.getEnableAppointmentsCreate(),a=Ue(e),i=this._getConfigFromDragDropConfigAggregation(a.getAggregation("dragDropConfig"),ge),n;if(t&&!i){n=this._createAppointmentsCreateConfig(e);a.addAggregation("dragDropConfig",n,true)}if(!t&&i){a.removeAggregation("dragDropConfig",i,true);i.destroy()}};pe.prototype._addDragDropInfo=function(e,a){e.addDragDropConfig(new T({groupName:le,sourceAggregation:"appointments",dragStart:function(e){var t=function(){var e=jQuery(".sapUiCalendarRowAppsOverlay");setTimeout(function(){e.addClass("sapUiCalendarRowAppsOverlayDragging")},0);jQuery(document).one("dragend",function(){e.removeClass("sapUiCalendarRowAppsOverlayDragging")})};if(a._isOneMonthsRowOnSmallSizes()||!a._isDraggingPerformed()){e.preventDefault();return}t()}}));a.addDragDropConfig(new R({groupName:le,targetAggregation:"_intervalPlaceholders",dragEnter:function(i){var n=i.getParameter("dragSession"),s=n.getDragControl(),r=a.getIntervalType(),o=a.getStartDate(),l=a.indexOfAggregation("_intervalPlaceholders",n.getDropControl()),h=a.getId(),g,d=function(){var e=jQuery(n.getIndicator()),a=n.getDropControl().getDomRef().getBoundingClientRect(),i=v.getElementById(h).getDomRef().getBoundingClientRect(),s=n.getDragControl().$().outerWidth(),r=t.getRTL(),o=r?Math.ceil(a.right)-i.left:i.right-Math.ceil(a.left);e.css("min-width",s<o?s:o).css(r?"border-left-width":"border-right-width",s>o?"0":"").css("margin-left",r?-(e.outerWidth()-parseFloat(e.context.style.width)):"")};if(e.hasListeners("appointmentDragEnter")){if(r===ne.Hour){g=this._calcNewHoursAppPos(o,s.getStartDate(),s.getEndDate(),l)}else if(r===ne.Day||r===ne.Week||(r===ne.OneMonth||r==="OneMonth")&&!a._isOneMonthsRowOnSmallSizes()){g=this._calcNewDaysAppPos(o,s.getStartDate(),s.getEndDate(),l)}else if(r===ne.Month){g=this._calcNewMonthsAppPos(o,s.getStartDate(),s.getEndDate(),l)}var p=e.fireAppointmentDragEnter({appointment:s,startDate:g.startDate,endDate:g.endDate,calendarRow:We(a.getParent())});if(!p){i.preventDefault();return}}else if(Ue(s.getParent())!==a){i.preventDefault();return}if(a.getIntervalType()!==ne.Hour){return}if(!n.getIndicator()){setTimeout(d,0)}else{d()}}.bind(this),drop:function(t){var i=t.getParameter("dragSession"),n=i.getDragControl(),s=a.getIntervalType(),r=a.getStartDate(),o=a.indexOfAggregation("_intervalPlaceholders",i.getDropControl()),l,h=t.getParameter("browserEvent"),g=h.metaKey||h.ctrlKey;if(s===ne.Hour){l=this._calcNewHoursAppPos(r,n.getStartDate(),n.getEndDate(),o)}else if(s===ne.Day||s===ne.Week||(s===ne.OneMonth||s==="OneMonth")&&!a._isOneMonthsRowOnSmallSizes()){l=this._calcNewDaysAppPos(r,n.getStartDate(),n.getEndDate(),o)}else if(s===ne.Month){l=this._calcNewMonthsAppPos(r,n.getStartDate(),n.getEndDate(),o)}a.$().find(".sapUiCalendarRowAppsOverlay").removeClass("sapUiCalendarRowAppsOverlayDragging");if(n.getStartDate().getTime()===l.startDate.getTime()&&n.getParent()===We(a.getParent())){return}e.fireAppointmentDrop({appointment:n,startDate:l.startDate,endDate:l.endDate,calendarRow:We(a.getParent()),copy:g})}.bind(this)}))};pe.prototype._calcNewHoursAppPos=function(e,t,a,i){var n=o._createUniversalUTCDate(e,null,true),s=o._createUniversalUTCDate(t,null,true),r=o._createUniversalUTCDate(a,null,true),l=V.getInstance(n.setUTCMinutes(0,0,0)+i*15*60*1e3);return{startDate:o._createLocalDate(l,true),endDate:o._createLocalDate(V.getInstance(l.getTime()+r.getTime()-s.getTime()),true)}};pe.prototype._calcNewDaysAppPos=function(e,t,a,i){var n=o._createUniversalUTCDate(e,null,true),s=o._createUniversalUTCDate(t,null,true),r=o._createUniversalUTCDate(a,null,true),l=r.getTime()-s.getTime();s.setUTCFullYear(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()+i);r=V.getInstance(s.getTime()+l);return{startDate:o._createLocalDate(s,true),endDate:o._createLocalDate(r,true)}};pe.prototype._calcNewMonthsAppPos=function(e,t,a,i){var n=o._createUniversalUTCDate(e,null,true),s=o._createUniversalUTCDate(t,null,true),r=o._createUniversalUTCDate(a,null,true),l=r.getTime()-s.getTime();s.setUTCFullYear(n.getUTCFullYear(),n.getUTCMonth()+i);r=V.getInstance(s.getTime()+l);return{startDate:o._createLocalDate(s,true),endDate:o._createLocalDate(r,true)}};pe.prototype._createResizeConfig=function(e){var t=Ue(e),a=new A({sourceAggregation:"appointments",targetAggregation:"_intervalPlaceholders",targetElement:Ue(e),dragStart:function(a){if(!e.getEnableAppointmentsResize()||t._isOneMonthsRowOnSmallSizes()||!t._isResizingPerformed()){a.preventDefault();return}var i=a.getParameter("dragSession"),n=t.$().find(".sapUiCalendarRowAppsOverlay"),s=jQuery(i.getIndicator()),r=i.getDragControl().$();s.addClass("sapUiDnDIndicatorHide");setTimeout(function(){n.addClass("sapUiCalendarRowAppsOverlayDragging")},0);jQuery(document).one("dragend",function(){n.removeClass("sapUiCalendarRowAppsOverlayDragging");s.removeClass("sapUiDnDIndicatorHide");r.css({width:"auto","min-width":"auto","z-index":"auto",opacity:1})});a.getParameter("browserEvent").dataTransfer.setDragImage(Ne(),0,0)},dragEnter:function(e){var t=e.getParameter("dragSession"),a=this.getTargetElement(),i=function(){var e=jQuery(t.getIndicator());e.addClass("sapUiDnDIndicatorHide")},n=t.getDropControl().getDomRef().getBoundingClientRect(),s=v.getElementById(a).getDomRef().getBoundingClientRect(),r={width:n.left+n.width-(t.getDragControl().$().position().left+s.left),"z-index":1,opacity:.8},o=r.width;if(n.width>0){while(o<=0){o+=n.width}while(o>n.width){o-=n.width}}r["min-width"]=o;t.getDragControl().$().css(r);if(!t.getIndicator()){setTimeout(i,0)}else{i()}},drop:function(t){var a=Ue(e),i=t.getParameter("dragSession"),n=i.getDragControl(),s=a.getIntervalType(),r=a.getStartDate(),o=a.indexOfAggregation("_intervalPlaceholders",i.getDropControl()),l;if(s===ne.Hour){l=this._calcResizeNewHoursAppPos(r,n.getStartDate(),n.getEndDate(),o)}else if(s===ne.Day||s===ne.Week||(s===ne.OneMonth||s==="OneMonth")&&!a._isOneMonthsRowOnSmallSizes()){l=this._calcResizeNewDaysAppPos(r,n.getStartDate(),n.getEndDate(),o)}else if(s===ne.Month){l=this._calcResizeNewMonthsAppPos(r,n.getStartDate(),n.getEndDate(),o)}a.$().find(".sapUiCalendarRowAppsOverlay").removeClass("sapUiCalendarRowAppsOverlayDragging");jQuery(i.getIndicator()).removeClass("sapUiDnDIndicatorHide");n.$().css({width:"auto","min-width":"auto","z-index":"auto",opacity:1});if(n.getEndDate().getTime()===l.endDate.getTime()){return}e.fireAppointmentResize({appointment:n,startDate:l.startDate,endDate:l.endDate,calendarRow:e})}.bind(this)});a.setProperty("groupName",he);return a};pe.prototype._calcResizeNewHoursAppPos=function(e,t,a,i){var n=o._createUniversalUTCDate(V.getInstance(e.getTime()),null,true),s=15*60*1e3,r=o._createUniversalUTCDate(t,null,true),l=V.getInstance(n.setUTCMinutes(0,0,0)+(i+1)*s);if(l.getTime()<=r.getTime()){l=V.getInstance(r.getTime()+s)}return{startDate:o._createLocalDate(r,true),endDate:o._createLocalDate(l,true)}};pe.prototype._calcResizeNewDaysAppPos=function(e,t,a,i){var n=o._createUniversalUTCDate(e,null,true),s=o._createUniversalUTCDate(t,null,true),r=V.getInstance(n.setUTCDate(n.getUTCDate()+i+1)),l={};l.startDate=o._createLocalDate(s);l.startDateTime=o._createLocalDate(s,true);l.endDate=o._createLocalDate(r);if(l.endDate<=l.startDate){l.endDate=o._createLocalDate(V.getInstance(r.setUTCDate(s.getUTCDate()+1)))}return{startDate:l.startDateTime,endDate:l.endDate}};pe.prototype._calcResizeNewMonthsAppPos=function(e,t,a,i){var n=o._createUniversalUTCDate(e,null,true),s=o._createUniversalUTCDate(t,null,true),r=V.getInstance(n.setUTCMonth(n.getUTCMonth()+i+1,1));if(o._monthsBetween(s,r,true)<0){r=V.getInstance(r.setUTCFullYear(s.getUTCFullYear(),s.getUTCMonth()+1,1))}return{startDate:o._createLocalDate(s,true),endDate:o._createLocalDate(r)}};pe.prototype._calcCreateNewAppHours=function(e,t,a){var[i,n]=[t,a].sort((e,t)=>e-t),s=o._createUniversalUTCDate(e,null,true),r=15*60*1e3,l=i,h=n+1,g=V.getInstance(s.setUTCMinutes(0,0,0)),d=V.getInstance(g.getTime()+l*r),p=V.getInstance(g.getTime()+h*r);return{startDate:o._createLocalDate(d,true),endDate:o._createLocalDate(p,true)}};pe.prototype._calcCreateNewAppDays=function(e,t,a){var[i,n]=[t,a].sort((e,t)=>e-t),s=o._createUniversalUTCDate(e,null,true),r=i,l=n+1,h=V.getInstance(s.getTime()),g=V.getInstance(s.getTime());return{startDate:o._createLocalDate(V.getInstance(h.setUTCDate(h.getUTCDate()+r))),endDate:o._createLocalDate(V.getInstance(g.setUTCDate(g.getUTCDate()+l)))}};pe.prototype._calcCreateNewAppMonths=function(e,t,a){var[i,n]=[t,a].sort((e,t)=>e-t),s=o._createUniversalUTCDate(e,null,true),r=i,l=n+1,h=V.getInstance(s.getTime()),g=V.getInstance(s.getTime());return{startDate:o._createLocalDate(V.getInstance(h.setUTCMonth(h.getUTCMonth()+r,1))),endDate:o._createLocalDate(V.getInstance(g.setUTCMonth(g.getUTCMonth()+l,1)))}};pe.prototype._getConfigFromDragDropConfigAggregation=function(e,t){var a=e,i=a&&a.length;for(var n=0;n<i;n++){if(a[n].getGroupName()===t){return a[n]}}return null};pe.prototype._createAppointmentsCreateConfig=function(e){var t=Ue(e),a=new A({targetAggregation:"_intervalPlaceholders",dragStart:function(a){if(!e.getEnableAppointmentsCreate()||t._isOneMonthsRowOnSmallSizes()||!t._isCreatingPerformed()){a.preventDefault();return}var i=a.getParameter("dragSession"),n=t.$().find(".sapUiCalendarRowAppsOverlay"),s=jQuery(i.getIndicator());setTimeout(function(){n.addClass("sapUiCalendarRowAppsOverlayDragging")},0);jQuery(document).one("dragend",function(){n.removeClass("sapUiCalendarRowAppsOverlayDragging");s.html("");s.removeClass("sapUiCalendarApp sapUiCalendarAppType01 sapUiAppCreate")});a.getParameter("browserEvent").dataTransfer.setDragImage(Ne(),0,0)},dragEnter:function(e){var a=e.getParameter("dragSession"),i=a.getDropControl().getDomRef().getBoundingClientRect(),n=function(){var e=jQuery(a.getIndicator());e.addClass("sapUiCalendarApp sapUiCalendarAppType01 sapUiAppCreate")};var s=a.getData("text")?parseFloat(a.getData("text").split("|")[0]):0;if(s){if(s<=i.left){a.setIndicatorConfig({left:s,width:Math.max(i.left+i.width-s,i.width)})}else{a.setIndicatorConfig({left:i.left,width:Math.max(s-i.left+i.width,i.width)})}}else{a.setData("text",i.left+"|"+t.indexOfAggregation("_intervalPlaceholders",a.getDropControl()))}if(!a.getIndicator()){setTimeout(n,0)}else{n()}},drop:function(a){var i=a.getParameter("dragSession"),n=jQuery(i.getIndicator()),s=t.getIntervalType(),r=Ue(e).getStartDate(),o=parseInt(i.getData("text").split("|")[1]),l=t.indexOfAggregation("_intervalPlaceholders",i.getDropControl()),h;if(s===ne.Hour){h=this._calcCreateNewAppHours(r,o,l)}else if(s===ne.Day||s===ne.Week||(s===ne.OneMonth||s==="OneMonth")&&!t._isOneMonthsRowOnSmallSizes()){h=this._calcCreateNewAppDays(r,o,l)}else if(s===ne.Month){h=this._calcCreateNewAppMonths(r,o,l)}e.fireAppointmentCreate({startDate:h.startDate,endDate:h.endDate,calendarRow:e});n.html("");n.removeClass("sapUiCalendarApp sapUiCalendarAppType01 sapUiAppCreate")}.bind(this)});a.setProperty("groupName",ge);return a};pe.prototype._updateHeaderButtons=function(){var e=this.getViewKey(),t=this._getView(e,true),a=t&&t.getIntervalType(),i=V.getInstance(this._dateNav.getStart().getTime()),n=V.getInstance(this._dateNav.getEnd().getTime()),s=this.getMinDate()?V.getInstance(this.getMinDate().getTime()):undefined,r=this.getMaxDate()?V.getInstance(this.getMaxDate().getTime()):undefined;if(a!=="Hour"){s&&s.setHours(0,0,0,0);r&&r.setHours(23,59,59,999);i.setHours(0,0,0,0);n.setHours(23,59,59,999)}if(a===ne.Month){const e=l.fromLocalJSDate(n);n.setDate(o._daysInMonth(e))}this._getHeader()._oPrevBtn.setEnabled(!s||i.getTime()>s.getTime());this._getHeader()._oNextBtn.setEnabled(!r||n.getTime()<r.getTime())};pe.prototype._getSpecialDates=function(){var e=this.getSpecialDates();for(var t=0;t<e.length;t++){var a=e[t].getSecondaryType()===X.NonWorking&&e[t].getType()!==X.NonWorking||e[t].getSecondaryType()===X.Working&&e[t].getType()!==X.Working;if(a){var i=new f;i.setType(e[t].getSecondaryType());i.setStartDate(e[t].getStartDate());if(e[t].getEndDate()){i.setEndDate(e[t].getEndDate())}e.push(i)}}return e};function Ne(){var e=jQuery("<span></span>").addClass("sapUiCalAppResizeGhost");e.appendTo(document.body);setTimeout(function(){e.remove()},0);return e.get(0)}function We(e){var t=e.getId();return v.getElementById(t.substring(0,t.indexOf(de)))}function Ee(e){return v.getElementById(e.getId()+de)}function Le(e){var t=Ee(e);return t?t.getHeader():null}function Ue(e){var t=Ee(e);return t?t.getTimeline():null}function Be(){const e=this.getSelectedRows();for(let t=0;t<e.length;t++){Ee(e[t]).setSelected(true)}}function xe(e){var t=[];var a=this.getRows();for(var i=0;i<a.length;i++){var n=a[i];var s=Ee(n);var r=s.getSelected();if(n.getSelected()!=r){n.setProperty("selected",r,true);t.push(n)}}if(!this.getSingleSelection()){Ye.call(this)}if(t.length>0){this.fireRowSelectionChange({rows:t})}}function ze(e){if(e<this._iBreakPointTablet){this._iSize=0}else if(e<this._iBreakPointDesktop){this._iSize=1}else{this._iSize=2}if(e<ye.PHONE){this._iSizeScreen=0}else if(e<ye.TABLET){this._iSizeScreen=1}else{this._iSizeScreen=2}}function Ke(e){var t="sapMSize"+e,a,i;for(a=0;a<3;a++){i="sapMSize"+a;if(i===t){this.addStyleClass(i)}else{this.removeStyleClass(i)}}}function Fe(){var e=this._getViews();this._oIntervalTypeSelect.destroyItems();var t;var a;for(t=0;t<e.length;t++){var i=e[t];a=new B(this.getId()+"-"+t,{key:i.getKey(),text:i.getDescription(),tooltip:i.getTooltip()});this._oIntervalTypeSelect.addItem(a)}if(this._oIntervalTypeSelect.getItems().length>4){this._getHeader()._convertViewSwitchToSelect()}else{this._getHeader()._convertViewSwitchToSegmentedButton()}this._oIntervalTypeSelect.setVisible(!(e.length===1))}function Je(e){var t=e.getParameter("selected");var a=this.getRows();if(t){a=this.getRows().filter(function(e){return!e.getSelected()})}this.selectAllRows(t);this.fireRowSelectionChange({rows:a})}function je(e){var t=e.oSource;var a=e.getParameter("type");var i=this.getRows();var n;var s;var r;var o;var l=0;var h=0;var g;for(l=0;l<i.length;l++){n=i[l];if(Ue(n)==t){h=l;break}}switch(a){case"sapup":r=t.getFocusedAppointment();o=r.getStartDate();if(h>0){h--}s=i[h];Ue(s).focusNearestAppointment(o);break;case"sapdown":r=t.getFocusedAppointment();o=r.getStartDate();if(h<i.length-1){h++}s=i[h];Ue(s).focusNearestAppointment(o);break;case"saphome":if(h>0){s=i[0];g=new jQuery.Event(a);g._bPlanningCalendar=true;Ue(s).onsaphome(g)}break;case"sapend":if(h<i.length-1){s=i[i.length-1];g=new jQuery.Event(a);g._bPlanningCalendar=true;Ue(s).onsapend(g)}break;default:break}}function Ye(){if(this._oSelectAllCheckBox){var e=this.getRows();var t=this.getSelectedRows();if(e.length==t.length&&t.length>0){this._oSelectAllCheckBox.setSelected(true)}else{this._oSelectAllCheckBox.setSelected(false)}}}function $e(){if(this.getSingleSelection()){if(this._oCalendarHeader.getAllCheckBox()){this._oCalendarHeader.setAllCheckBox()}else if(this._oInfoToolbar.getContent().length>2){this._oInfoToolbar.removeContent(this._oSelectAllCheckBox)}}else{if(!this._oSelectAllCheckBox){this._oSelectAllCheckBox=new J(this.getId()+"-All",{text:this._oRB.getText("COLUMNSPANEL_SELECT_ALL")});this._oSelectAllCheckBox.attachEvent("select",Je,this)}if(this._iSizeScreen<2||!this.getShowRowHeaders()){var e=this._oInfoToolbar.indexOfContent(this._oSelectAllCheckBox);if(this._iSizeScreen<2){if(e<this._oInfoToolbar.getContent().length-1){this._oInfoToolbar.addContent(this._oSelectAllCheckBox)}}else if(e<0||e>1){if(e>1){this._oInfoToolbar.removeContent(this._oSelectAllCheckBox)}this._oInfoToolbar.insertContent(this._oSelectAllCheckBox,1)}}else{this._oCalendarHeader.setAllCheckBox(this._oSelectAllCheckBox)}}}pe.prototype._setSelectionMode=function(){var e=this.getAggregation("table");var t=e.getMode();var a;if(this.getSingleSelection()){if(!this.getShowRowHeaders()&&this.getRows().length==1){a=Q.None}else{a=Q.SingleSelectMaster}}else{a=Q.MultiSelect}if(t!=a){e.setMode(a)}};pe.prototype.calcIntervalOffset=function(e){var t=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());var a=this.getMinDate()||e;var i=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate());return Math.round((t-i)/1e3/60/60/24/this._getView(this.getViewKey()).getIntervalSize())};pe.prototype._getDateFromIndex=function(e){var t=V.getInstance(this.getMinDate());t.setDate(t.getDate()+e*this._getView(this.getViewKey()).getIntervalSize());return t};pe.prototype._getRelativeInfo=function(){var e={},t=this._getView(this.getViewKey(),true);e.iIntervalSize=t.getIntervalSize();e.bIsRelative=t.getRelative();e.oMinDate=this.getMinDate();e._getDateFromIndex=this._getDateFromIndex.bind(this);e.intervalLabelFormatter=t.getIntervalLabelFormatter()?t.getIntervalLabelFormatter():function(e){return e};e._getIndexFromDate=this.calcIntervalOffset.bind(this);return e};function Ge(){return this._oTimesRow||this._oDatesRow||this._oMonthsRow||this._oWeeksRow||this._oOneMonthsRow}function qe(){if(!this._getHeader()){return 0}var e=this._getHeader().getDomRef(),t=0,a;if(e){a=e.getBoundingClientRect();t=parseInt(a.height)}return t}function Xe(e,t,a){e.events=e.events||{};if(!e.events[t]){e.events[t]=a}else{var i=e.events[t];e.events[t]=function(){a.apply(this,arguments);i.apply(this,arguments)}}}return pe});
//# sourceMappingURL=PlanningCalendar.js.map