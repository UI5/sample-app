/*!
 * OpenUI5
 * (c) Copyright 2026 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element","sap/ui/core/library","sap/ui/core/Lib","sap/ui/dom/detectTextSelection","./library","./ListItemBase","./ColumnListItemRenderer","sap/ui/thirdparty/jquery","sap/ui/dom/jquery/Selectors"],function(t,e,n,o,i,s,r){"use strict";var a=i.ListType;var p=e.VerticalAlign;var l=s.extend("sap.m.ColumnListItem",{metadata:{interfaces:["sap.m.ITableItem"],library:"sap.m",properties:{vAlign:{type:"sap.ui.core.VerticalAlign",group:"Appearance",defaultValue:p.Inherit}},defaultAggregation:"cells",aggregations:{cells:{type:"sap.ui.core.Control",multiple:true,singularName:"cell",bindable:"bindable"}}},renderer:r});var u=t.extend("sap.m.TablePopin",{ontap:function(t){if(t.isMarked()||o(this.getDomRef())){return t.stopImmediatePropagation(true)}},ontouchend:function(){if(document.activeElement===this.getFocusDomRef()){this.getParent().focus({preventScroll:true})}},getFocusDomRef:function(){return this.getParent().getDomRef("subcont")}});l.prototype.TagName="tr";l.prototype.init=function(){s.prototype.init.call(this);this._bNeedsTypeColumn=false;this._aClonedHeaders=[]};l.prototype.onBeforeRendering=function(){s.prototype.onBeforeRendering.call(this);this.aAriaOwns=[];if(this._oPopin&&this._oDomRef){this.$Popin().off()}};l.prototype.onAfterRendering=function(){if(this._oPopin){this.$().attr("aria-owns",this.aAriaOwns.join(" "));this.isActionable(true)&&this.$Popin().on("mouseenter mouseleave",t=>{this.toggleStyleClass("sapMPopinHovered",t.type=="mouseenter")})}s.prototype.onAfterRendering.call(this);this._checkTypeColumn();if(this.bOutput!==false&&document.activeElement.id===this.getId()){this.getTable()?._setFirstLastVisibleCells(document.activeElement)}};l.prototype.exit=function(){s.prototype.exit.call(this);this._checkTypeColumn(false);this._destroyClonedHeaders();if(this._oPopin){this._oPopin.destroy(true);this._oPopin=null}};l.prototype.setVisible=function(t){s.prototype.setVisible.call(this,t);if(!t&&this.hasPopin()){this.removePopin()}return this};l.prototype.getTable=function(){var t=this.getParent();if(t&&t.isA("sap.m.Table")){return t}};l.prototype.getPopin=function(){if(!this._oPopin){this._oPopin=new u({id:this.getId()+"-sub"}).addDelegate({ontouchstart:this.ontouchstart,ontouchmove:this.ontouchmove,ontap:this.ontap,ontouchend:this.ontouchend,ontouchcancel:this.ontouchcancel,onsapup:this.onsapup,onsapdown:this.onsapdown,oncontextmenu:this.oncontextmenu,onkeydown:this.onkeydown,onfocusin:this.onfocusin,onfocusout:this.onfocusout},this).setParent(this,null,true)}return this._oPopin};l.prototype.$Popin=function(){return this.$("sub")};l.prototype.hasPopin=function(){return this._oPopin};l.prototype.removePopin=function(){this._oPopin&&this.$Popin().remove()};l.prototype.getTabbables=function(t){const e=t?this.$().find(".sapMListTblCell"):this.$();return e.add(this.$Popin()).find(":sapTabbable")};l.prototype.getDropAreaRect=function(){var t=null;var e=this.getDomRef();var n=e.getBoundingClientRect().toJSON();if(this._oPopin&&(t=this.getDomRef("sub"))){var o=t.getBoundingClientRect();n.bottom=o.bottom;n.height+=o.height}return n};l.prototype.getAccessibilityType=function(t){return t.getText("ACC_CTR_TYPE_ROW")};l.prototype.getContentAnnouncementOfCell=function(t){return c(t,this.getCells(),false)};function c(t,e,o){const i=e[t.getInitialOrder()];let r=s.getAccessibilityText(i,true);if(o){const e=document.activeElement.classList.contains("sapMListTblSubCnt");const n=t.getAccessibilityDescription(!e);r=n+" "+r}else if(i.$().parent().find(":sapTabbable").length>0){r=n.getResourceBundleFor("sap.m").getText("TABLE_CELL_INCLUDES",[r])}return r}l.prototype.getContentAnnouncementOfPopin=function(){const t=this.getCells();const e=this.getTable()._getVisiblePopin().map(function(e){return c(e,t,true)});let o=e.filter(Boolean).join(" . ").trim();if(this.$Popin().find(":sapTabbable").length>0){o=n.getResourceBundleFor("sap.m").getText("TABLE_CELL_INCLUDES",[o])}return o};l.prototype.getContentAnnouncementOfRowAction=function(){if(this.getEffectiveType()===a.Inactive){return s.getAccessibilityText(null,true)}};l.prototype.getContentAnnouncement=function(){const t=this.getTable();if(!t){return}const e=this.getCells();const n=t.getRenderedColumns().map(function(t){return c(t,e,true)});return n.filter(Boolean).join(" . ").trim()};l.prototype.getGroupAnnouncement=function(){return this.$().prevAll(".sapMGHLI:first").text()};l.prototype.updateSelectedDOM=function(t,e){s.prototype.updateSelectedDOM.apply(this,arguments);e.find(".sapMTblCellFocusable").attr("aria-selected",t);if(this.hasPopin()){this.$("subcont").attr("aria-selected",t)}};l.prototype.onfocusin=function(e){if(e.isMarked()){return}if(e.srcControl===this){this.$().children(".sapMListTblCellDup").find(":sapTabbable").attr("tabindex",-1)}const n=this.getTable();const o=e.target;let i;if(o.classList.contains("sapMListTblCell")){const e=t.getElementById(o.getAttribute("data-sap-ui-column"));i=this.getContentAnnouncementOfCell(e)}else if(o.classList.contains("sapMListTblSubCnt")){i=this.getContentAnnouncementOfPopin()}else if(o.classList.contains("sapMListTblNavCol")){i=this.getContentAnnouncementOfRowAction()}else if(o.classList.contains("sapMListTblActionsCol")){i=this._getCustomActionsAnnouncement(true)}if(i){n.updateInvisibleText(i);e.setMarked("contentAnnouncementGenerated")}s.prototype.onfocusin.apply(this,arguments)};l.prototype.onfocusout=function(t){if(t.isMarked()){return}const e=t.target;if(e.matches(".sapMListTblCell")||e.matches(".sapMListTblSubCnt")){this.getTable().removeInvisibleTextAssociation(e)}s.prototype.onfocusout.apply(this,arguments)};l.prototype.onsapenter=l.prototype.onsapspace=function(t){if(t.isMarked()){return}var e=t.target.id;var n="on"+t.type;if(e==this.getId()+"-ModeCell"){t.target=this.getDomRef();n=this.getMode()=="Delete"?"onsapdelete":"onsapspace"}else if(e==this.getId()+"-TypeCell"){t.target=this.getDomRef();if(this.getEffectiveType()=="Navigation"){n="onsapenter"}else{t.code="KeyE";t.ctrlKey=true;n="onkeydown"}}s.prototype[n].call(this,t)};l.prototype.setType=function(t){s.prototype.setType.call(this,t);this._checkTypeColumn();return this};l.prototype.setParent=function(){s.prototype.setParent.apply(this,arguments);this._checkTypeColumn();return this};l.prototype._checkTypeColumn=function(t){if(!this.getParent()){return}if(t==undefined){t=this._needsTypeColumn()}if(this._bNeedsTypeColumn!=t){this._bNeedsTypeColumn=t;this.informList("TypeColumnChange",t)}};l.prototype._needsTypeColumn=function(){if(!this.getVisible()){return false}const t=this.getEffectiveType();return t===a.Navigation?true:t.startsWith(a.Detail)&&this._getMaxActionsCount()===-1};l.prototype._addClonedHeader=function(t){return this._aClonedHeaders.push(t)};l.prototype._destroyClonedHeaders=function(){if(this._aClonedHeaders.length){this._aClonedHeaders.forEach(function(t){t.destroy("KeepDom")});this._aClonedHeaders=[]}};l.prototype._activeHandlingInheritor=function(){this._toggleActiveClass(true)};l.prototype._inactiveHandlingInheritor=function(){this._toggleActiveClass(false)};l.prototype._toggleActiveClass=function(t){if(this.hasPopin()){this.$Popin().toggleClass("sapMLIBActive",t)}};return l});
//# sourceMappingURL=ColumnListItem.js.map